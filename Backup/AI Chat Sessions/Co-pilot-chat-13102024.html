<!DOCTYPE html>
<!-- saved from url=(0037)https://copilot.microsoft.com/?dpwa=1 -->
<html dir="ltr" lang="en-gb" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:web="http://schemas.live.com/Web/" data-theme="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Co-pilot-chat-13102024_files/clarity.js.download"></script><script type="text/javascript" nonce="">//<![CDATA[
si_ST=new Date
//]]></script><!--pc--><title>Microsoft Copilot: Your AI companion</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="referrer" content="origin-when-cross-origin"><meta name="description" content="Microsoft Copilot is your companion to inform, entertain and inspire. Get advice, feedback and straightforward answers. Try Copilot now."><meta name="apple-itunes-app" content="app-id=6472538445"><meta property="og:title" content="Microsoft Copilot: Your AI companion"><meta property="og:type" content="website"><meta property="og:site_name" content="Microsoft Copilot: Your AI companion"><meta property="og:description" content="Microsoft Copilot is your companion to inform, entertain and inspire. Get advice, feedback and straightforward answers. Try Copilot now."><meta property="og:url" content="http://copilot.microsoft.com/copilot/"><meta property="og:image" content="https://studiostaticassetsprod.azureedge.net/bundle-cmc/images/meta-image.jpg"><meta property="og:image:width" content="600"><meta property="og:image:height" content="315"><link href="https://studiostaticassetsprod.azureedge.net/bundle-cmc/favicon.ico" data-orighref="" rel="icon"><link href="https://studiostaticassetsprod.azureedge.net/bundle-cmc/favicon.svg" data-orighref="" rel="icon"><link href="https://copilot.microsoft.com/pwa/copilot-manifest.webmanifest" data-orighref="" rel="manifest"><link href="https://copilot.microsoft.com/cricket/manifest.json" data-orighref="" rel="manifest" title="Bing" type="application/json"><script type="module" nonce="">//<![CDATA[
window.appStart = performance.now();;
//]]></script><script type="text/javascript" nonce="">//<![CDATA[
_G={Region:"IN",Lang:"en-GB",ST:(typeof si_ST!=='undefined'?si_ST:new Date),Mkt:"en-GB",RevIpCC:"in",RTL:false,Ver:"41",IG:"242AC0D6482C44889D9FABB6CCB8AFC3",EventID:"670bf7ba2f9b4c789db7de8c567e9a01",V:"web",P:"discoverbing",DA:"PUSE01",SUIH:"c2VUQcoLZj1Ls6LO4PsACg",adc:"b_ad",EF:{cookss:1,emptyclientcookdom:1,bmcov:1,crossdomainfix:1,bmasynctrigger:1,bmasynctrigger3:1,getslctspt:1,newtabsloppyclick:1,chevroncheckmousemove:1,sharepreview:1,shareoutimage:1,sharefixreadnum:1,sharepreviewthumbnailid:1,shareencodefix:1,chatskip2content:1,fablogfix:1,uaclickbackas:1,uaasnodisappear:1,uaasnodisappear:1},gpUrl:"\/fd\/ls\/GLinkPing.aspx?" }; _G.lsUrl="/fd/ls/l?IG="+_G.IG ;curUrl="https:\/\/copilot.microsoft.com\/";function si_T(a){ if(document.images){_G.GPImg=new Image;_G.GPImg.src=_G.gpUrl+'IG='+_G.IG+'&'+a;}return true;}_G.BAT="0";_G.NTT="600000";_G.CTT="3000";_G.BNFN="Default";_G.LG="160";_G.FilterFlareInterval=5;;var amd,define,require;(function(n){function e(n,i,u){t[n]||(t[n]={dependencies:i,callback:u},r(n))}function r(n){if(n){if(n)return u(n)}else{if(!f){for(var r in t)u(r);f=!0}return i}}function u(n){var s,e;if(i[n])return i[n];if(t.hasOwnProperty(n)){var h=t[n],f=h.dependencies,l=h.callback,a=r,o={},c=[a,o];if(f.length<2)throw"invalid usage";else if(f.length>2)for(s=f.slice(2,f.length),e=0;e<s.length;e++)c.push(u(s[e]));return l.apply(this,c),i[n]=o,o}}var t={},i={},f=!1;n.define=e;n.require=r})(amd||(amd={}));define=amd.define;require=amd.require;var _w=window,_d=document,sb_ie=window.ActiveXObject!==undefined,sb_i6=sb_ie&&!_w.XMLHttpRequest,_ge=function(n){return _d.getElementById(n)},_qs=function(n,t){return t=typeof t=="undefined"?_d:t,t.querySelector?t.querySelector(n):null},sb_st=function(n,t){return setTimeout(n,t)},sb_rst=sb_st,sb_ct=function(n){clearTimeout(n)},sb_gt=function(){return(new Date).getTime()},sj_gx=function(){return sb_i6?new ActiveXObject("MSXML2.XMLHTTP"):new XMLHttpRequest};_w.sj_ce=function(n,t,i){var r=_d.createElement(n);return t&&(r.id=t),i&&(r.className=i),r};_w.sj_cook=_w.sj_cook||{get:function(n,t){var i=_d.cookie.match(new RegExp("\\b"+n+"=[^;]+")),r;return t&&i?(r=i[0].match(new RegExp("\\b"+t+"=([^&]*)")),r?r[1]:null):i?i[0]:null}};_w.sk_merge||(_w.sk_merge=function(n){_d.cookie=n});_w.ChatMergeLogHelper={getBotRequestId:function(n){var t=this.getChatJoinKeys(n);return t?t.rid:null},getConversationIg:function(n){var t=this.getChatJoinKeys(n);return t?t.ig:null},getChatJoinKeys:function(n){var i,r,u,t,o,f,e;return(function(n){n.Home="home";n.Search="search";n.Conversation="conversation";n.OffStage="off-stage";n.Notebook="notebook";n.GPTCreator="gpt-creator"}(u||(u={})),t=_w.GlobalInstTracker,o=null,typeof t!="undefined"&&t&&t.convModeToJoinKeys&&typeof _w.CIB!="undefined"&&((r=(i=_w.CIB)===null||i===void 0?void 0:i.vm)===null||r===void 0?void 0:r.mode)&&n)?(f=_w.CIB.vm.mode,f===u.Notebook?t.convModeToJoinKeys.get(f):t.convModeToJoinKeys.get("conversation")):(e=location.href.match(new RegExp("[?&]IID=Codex-[^?&#]*")))&&e[0]?{ig:_G.IG,rid:e[0].split("=Codex-")[1]}:o}};
//]]></script><link rel="stylesheet" href="./Co-pilot-chat-13102024_files/styles.css" type="text/css"><style type="text/css">#b_header #id_h{content-visibility:hidden}#b_results>.b_ans:not(.b_top):nth-child(n+5) .rqnaContainerwithfeedback #df_listaa{content-visibility:auto;contain-intrinsic-size:648px 205px}#b_results>.b_algo:not(.b_algoBorder):nth-child(n+5)>h2{content-visibility:auto;contain-intrinsic-size:608px 24px}#b_results>.b_algo:not(.b_algoBorder):nth-child(n+5) .b_caption:not(.b_rich):not(.b_capmedia):not(.b_snippetgobig):not(.rebateContent){content-visibility:auto;contain-intrinsic-size:608px 65px;padding-right:16px;margin-right:-16px;margin-left:-16px;padding-left:16px}#b_results>.b_algo:not(.b_algoBorder):nth-child(n+5) .b_caption.b_rich .captionMediaCard .wide_wideAlgo{content-visibility:auto;contain-intrinsic-size:370px 120px}#b_results>.b_algo:not(.b_algoBorder):nth-child(n+5) .scs_icn{content-visibility:auto}#b_results>.b_algoCV:not(.b_algoBorder):nth-child(n+5)>h2{content-visibility:visible}#b_results>.b_algoCV:not(.b_algoBorder):nth-child(n+5) .b_caption:not(.b_rich):not(.b_capmedia):not(.b_snippetgobig):not(.rebateContent){content-visibility:visible}#b_results>.b_algoCV:not(.b_algoBorder):nth-child(n+5) .b_caption.b_rich .captionMediaCard .wide_wideAlgo{content-visibility:visible}#b_results>.b_algoCV:not(.b_algoBorder):nth-child(n+5) .scs_icn{content-visibility:visible}#b_results>.b_ans:nth-child(n+7) .b_rs:not(.pageRecoContainer){content-visibility:auto;contain-intrinsic-size:608px 296px}#b_results>.b_ans:nth-child(n+7) .b_rs:not(.pageRecoContainer) .b_rsv3{padding-bottom:1px}#b_results>.b_pag{content-visibility:auto;contain-intrinsic-size:628px 45px}#b_footer>#b_footerItems{content-visibility:auto;contain-intrinsic-size:1px 24px}.cnt_vis_hid{content-visibility:hidden}#b_header #id_h{content-visibility:visible}</style><script type="text/javascript" nonce="">//<![CDATA[
var logJSText=function(n,t){t===void 0&&(t=null);(new Image).src=_G.lsUrl+'&Type=Event.ClientInst&DATA=[{"T":"CI.ClientInst","FID":"CI","Name":"'+escape(n)+(t?'","Text":"'+escape(t):"")+'"}]'},logCSP=function(n){(new Image).src=_G.lsUrl+'&Type=Event.ClientInst&DATA=[{"T":"CI.Error","FID":"CI","Name":"CSPViolation","Text":"'+escape(n)+'"}]'},getHref=function(){return location.href};try{var ignErr=["ResizeObserver loop","Script error"],ignCSPErr=["unsafe-eval"],maxErr=3,ignoreCurrentError=function(n,t){return(ignErr.some(function(t){return n.includes(t)})||ignCSPErr.some(function(t){return n.includes(t)}))?ignCSPErr.some(function(t){return n.includes(t)})&&t.filename&&!t.filename.includes("chrome-extension://")?!1:(t!=null&&(typeof sj_sp!="undefined"&&sj_sp(t),typeof sj_pd!="undefined"&&sj_pd(t)),!0):!1},regexEsc=function(n){return n.replace(/([.?*+^$&[\]\\(){}|<>-])/g,"\\$1")},ignoreCSPLog=function(n){return["javascript:void(0)","javascript: void(0)","javascript:void()"].some(function(t){return n.sample.includes(t)})};window.jsErrorHandler=function(n){var f,p,h,rt,ut,u,e,ft,o,a,v,s;try{if(f='"noMessage"',p=(n.error||n).message||f,ignoreCurrentError(p,n))return;if(h=(window.ERC?window.ERC:0)+1,window.ERC=h,h>maxErr){logJSText("max errors reached");return}var c=n.error||n,w=n.filename,b=n.lineno,k=n.colno,d=n.extra,l=c.severity||"Error",g=c.message||f,i=c.stack,t='"'+escape(g.replace(/"/g,""))+'"',nt=new RegExp(regexEsc(getHref()),"g"),tt=window.lirab,it=window.liraa,r=tt?" hint == ["+tt:"";if(r=r+(it?", "+it+")":r?"]":""),i){for(rt=/\(([^\)]+):[0-9]+:[0-9]+\)/g,u={};(ut=rt.exec(i))!==null;)e=ut[1],u[e]?u[e]++:u[e]=1;o=0;for(a in u)u[a]>1&&(v=regexEsc(a),ft=new RegExp(v,"g"),i=i.replace(ft,o),i+="#"+o+"="+v,o++);i=i.replace(nt,"self").replace(/"/g,"");t+=',"Stack":"'+(escape(i)+'"')}if(w?t+=',"Meta":"'+escape(w.replace(nt,"self"))+r+'"':r&&(t+=',"Meta":"'+r+'"'),b&&(t+=',"Line":"'+b+'"'),k&&(t+=',"Char":"'+k+'"'),d&&(t+=',"ExtraInfo":"'+d+'"'),g===f)if(l="Warning",t+=',"ObjectToString":"'+n.toString()+'"',JSON&&JSON.stringify)t+=',"JSON":"'+escape(JSON.stringify(n))+'"';else for(s in n)n.hasOwnProperty(s)&&(t+=',"'+s+'":"'+n[s]+'"');var et=(new Date).getTime(),ot='"T":"CI.'+l+'","FID":"CI","Name":"JS'+l+'","Text":'+t+"",st="<E><T>Event.ClientInst<\/T><IG>"+_G.IG+"<\/IG><TS>"+et+"<\/TS><D><![CDATA[[{"+ot+"}]]\]><\/D><\/E>",ht="<ClientInstRequest><Events>"+st+"<\/Events><STS>"+et+"<\/STS><\/ClientInstRequest>",y=new XMLHttpRequest;y.open("POST","/fd/ls/lsp.aspx?",!0);y.setRequestHeader("Content-Type","text/xml");y.send(ht);typeof sj_evt!="undefined"&&sj_evt.fire("ErrorInstrumentation",t)}catch(ct){logJSText("MetaJSError","Failed to execute error handler. "+ct.message)}};window.cspErrorHandler=function(n){try{ignoreCSPLog(n)||logCSP(n.sample)}catch(t){logJSText("MetaJSError","Failed to execute CSP error handler. "+t.message)}};window.addEventListener&&(window.addEventListener("error",window.jsErrorHandler,!1),window.addEventListener("unhandledrejection",window.jsErrorHandler,!1),window.addEventListener("securitypolicyviolation",window.cspErrorHandler))}catch(e){logJSText("MetaJSError","Failed to bind error handler "+e.message)};_w.bbe="A:rms:answers:Shared:BingCore.Bundle";define("fallback",["require","exports"],function(n,t){function f(){return function(){for(var r,h,c,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(r=s(arguments.callee),u&&(h=e(r),h.toString()!=f().toString()))return h.apply(null,arguments);c=i[r].q;t[0]==="onPP"&&o();c.push(t)}}function s(n){for(var t in i)if(i[t].h===n)return t}function e(n,t){for(var u,e=n.split("."),i=_w,r=0;r<e.length;r++)u=e[r],typeof i[u]=="undefined"&&t&&(i[u]=r===e.length-1?f():{}),i=i[u];return i}function o(){var e=i["rms.js"].q,o,f,r,n,s,u,t;if(e.length>0)for(o=!1,f=0;f<e.length;f++){for(r=e[f],n=0;n<r.length;n++)if(s=_w.bbe,u=r[n][s],u||(u=r[n]["A:rmsBu0"]),u){t=_d.createElement("script");t.setAttribute("data-rms","1");t.setAttribute("crossorigin","anonymous");t.src=u;t.type="text/javascript";setTimeout(function(){_d.body.appendChild(t)},0);r.splice(n,1);o=!0;break}if(o)break}}function h(){var n,t,f;for(u=!1,n=0;n<r.length;n++)t=r[n],f=e(t,!0),i[t]={h:f,q:[]}}function c(){for(var t,n=0;n<r.length;n++){var o=r[n],s=i[o].q,h=e(o);for(t=0;t<s.length;t++)h.toString()!==f().toString()&&h.apply(null,s[t])}u=!0}function l(n,t,i,r){n&&((n===_w||n===_d||n===_d.body)&&t=="load"?_w.sj_evt.bind("onP1",i,!0):n.addEventListener?n.addEventListener(t,i,r):n.attachEvent?n.attachEvent("on"+t,i):n["on"+t]=i)}t.__esModule=!0;t.replay=void 0;var r=["rms.js","sj_evt.bind","sj_evt.fire","sj_jb","sj_wf","sj_cook.get","sj_cook.set","sj_pd","sj_sp","sj_be","sj_go","sj_ev","sj_ue","sj_evt.unbind","sj_et","Log.Log","sj_mo","sj_so"],i={},u=!1;_w.fb_is=o;t.replay=c;h();_w.sj_be=l});function lb(){_w.si_sendCReq&&sb_st(_w.si_sendCReq,800);_w.lbc&&_w.lbc()};(function(){function n(n){n=sb_ie?_w.event:n;(!n.altKey||n.ctrlKey||n.shiftKey)&&(n.key&&n.key==="Enter"||n.keyCode&&n.keyCode===13)&&_w.si_ct(sb_ie?n.srcElement:n.target,!1,n,"enter")}sj_be(document,"keydown",n,!1)})();(function(){function n(n){_w.si_ct(sb_ie?_w.event.srcElement:n.target,!1,_w.event||n)}sj_be(document,"mousedown",n,!1);sj_evt.bind("sydFSCLoaded",function(){var t;((t=CIB===null||CIB===void 0?void 0:CIB.config)===null||t===void 0?void 0:t.bing)&&(CIB.config.bing.sendClickBeacon=n)},!0)})();_w.si_sbwu=function(n){var u=_G.BQIG==null?_G.IG:_G.BQIG,r="/fd/ls/GLinkPingPost.aspx?",t,i;if(r+=n.length>2&&n.substring(0,3)==="IG="?n:"IG="+u+n,t="sendBeacon",i=!1,navigator&&navigator[t])try{navigator[t](r,"");i=!0}catch(f){}return i};ClTrCo={};var ctcc=0,clc=_w.ClTrCo||{},SerpMode;(function(n){n.Home="home";n.Search="search";n.Conversation="conversation";n.OffStage="off-stage";n.Notebook="notebook";n.GPTCreator="gpt-creator"})(SerpMode||(SerpMode={}));_w.si_ct=function(n,t,i,r){var w,b,u,e,o,l,f,nt,a,k,c,p,d;if(clc.SharedClickSuppressed)return!0;u="getAttribute";try{for(;n!==document.body;n=n.parentNode){if(!n||n===document||n[u]("data-noct"))break;if(e=(n.tagName==="A"||n[u]("data-clicks"))&&(n[u]("h")||n[u]("data-h")||n[u]("data-cspi"))||n[u]("_ct"),e){o=n[u]("_ctf");l=-1;i&&(i.type==="keydown"?l=-2:i.button!=null&&(l=i.button));o&&_w[o]||(o="si_T");o==="si_T"&&(f=n[u]("href"),_G!==undefined&&_G.EF!==undefined&&_G.EF.newtabredironclicktracking===1&&f.indexOf("/newtabredir")==0?(nt=new RegExp("[?&]?url=([^&]*)(&|$)"),a=f.match(nt),a&&(f=f.indexOf("&be=1")>=0?encodeURIComponent(atob(decodeURIComponent(a[1]))):a[1])):f=encodeURIComponent(n[u]("href")),clc.furl&&!n[u]("data-private")?e+="&url="+f:clc.mfurl&&(e+="&abc="+f));r&&(e+="&source="+r);k="";clc.mc&&(k="&c="+ctcc++);var v=_w.ChatMergeLogHelper,y=_w.GlobalInstTracker,s,h="";if(typeof v!="undefined"&&v&&typeof v.getChatJoinKeys=="function"&&(c=v.getChatJoinKeys(!0),c&&typeof y!="undefined"&&y&&typeof y.getRidFromInstTracker=="function"&&(p=null,typeof _w.CIB!="undefined"&&((b=(w=_w.CIB)===null||w===void 0?void 0:w.vm)===null||b===void 0?void 0:b.mode)&&(p=_w.CIB.vm.mode),(d=e.match(new RegExp("ID=[^?&#]*")))&&d[0]))){var tt=d[0].split("ID=")[1].split(","),g=tt[0].split("_")[0],rt=tt[1].split(".")[0];(g.length>5&&g.substring(0,6)==="Codex-"||p===SerpMode.Notebook||p===SerpMode.Conversation)&&(s=y.getRidFromInstTracker(g,rt),s||(s=c.rid),c.ig&&(h+="IG="+c.ig))}h+="&"+e+k;s&&(h+="&rid="+s);_w.si_sbwu(h)||_w[o]&&_w[o](h,n,i,l);break}if(t)break}}catch(it){_w.SharedLogHelper?SharedLogHelper.LogWarning("clickEX",null,it):(new Image).src=_G.lsUrl+'&Type=Event.ClientInst&DATA=[{"T":"CI.Warning","FID":"CI","Name":"JSWarning","Text":'+it.message+"}]"}return!0};_w.si_sbwu||(_w.si_sbwu=function(){return!1}),function(){_w._G&&(_G.si_ct_e="click")}();var wlc_d = 1500, wlc_t =63864434362;;var perf;(function(n){function f(n){return i.hasOwnProperty(n)?i[n]:n}function e(n){var t="S";return n==0?t="P":n==2&&(t="M"),t}function o(n){for(var c,i=[],t={},r,l=0;l<n.length;l++){var a=n[l],o=a.v,s=a.t,h=a.k;s===0&&(h=f(h),o=o.toString(36));s===3?i.push("".concat(h,":").concat(o)):(r=t[s]=t[s]||[],r.push("".concat(h,":").concat(o)))}for(c in t)t.hasOwnProperty(c)&&(r=t[c],i.push("".concat(e(+c),':"').concat(r.join(","),'"')));return i.push(u),i}for(var r=["redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd","unloadEventStart","unloadEventEnd","firstChunkEnd","secondChunkStart","htmlEnd","pageEnd","msFirstPaint"],u="v:1.1",i={},t=0;t<r.length;t++)i[r[t]]=t;n.compress=o})(perf||(perf={}));window.perf=window.perf||{},function(n){n.log=function(t,i){var u=n.compress(t),e,r;u.push('T:"CI.Perf",FID:"CI",Name:"PerfV2"');var s="/fd/ls/lsp.aspx?",h="sendBeacon",f=_w.ChatMergeLogHelper;typeof f!="undefined"&&typeof f.getBotRequestId=="function"&&(e=f.getBotRequestId(),e&&u.push('rid:"'.concat(e,'"')));var l="<E><T>Event.ClientInst<\/T><IG>".concat(_G.IG,"<\/IG><TS>").concat(i,"<\/TS><D><![CDATA[{").concat(u.join(","),"}]\]><\/D><\/E>"),c="<ClientInstRequest><Events>".concat(l,"<\/Events><STS>").concat(i,"<\/STS><\/ClientInstRequest>"),o=!_w.navigator||!navigator[h];if(!o)try{navigator[h](s,c)}catch(a){o=!0}o&&(r=sj_gx(),r.open("POST",s,!0),r.setRequestHeader("Content-Type","text/xml"),r.send(c))}}(window.perf);var perf;(function(n){function a(){return c(Math.random()*1e4)}function o(){return y?c(f.now())+l:+new Date}function v(n,r,f){t.length===0&&i&&sb_st(u,1e3);t.push({k:n,v:r,t:f})}function p(n){return i||(r=n),!i}function w(n,t){t||(t=o());v(n,t,0)}function b(n,t){v(n,t,1)}function u(){var u,f;if(t.length){for(u=0;u<t.length;u++)f=t[u],f.t===0&&(f.v-=r);t.push({k:"id",v:e,t:3});n.log(t,o());t=[];i=!0}}function k(){r=o();e=a();i=!1;sj_evt.bind("onP1",u)}var s="performance",h=!!_w[s],f=_w[s],y=h&&!!f.now,c=Math.round,t=[],i=!1,l,r,e;h?l=r=f.timing.navigationStart:r=_w.si_ST?_w.si_ST:+new Date;e=a();n.setStartTime=p;n.mark=w;n.record=b;n.flush=u;n.reset=k;sj_be(window,"load",u,!1);sj_be(window,"beforeunload",u,!1)})(perf||(perf={}));_w.si_PP=function(n,t,i){var r,s,a,c,e,l,o,v;if(!_G.PPS){for(s=["FC","BC","SE","TC","H","BP",null];r=s.shift();)s.push('"'+r+'":'+(_G[r+"T"]?_G[r+"T"]-_G.ST:-1));var u=_w.perf,h="navigation",r,f=i||_w.performance&&_w.performance.timing;if(f&&u){if(a=f.navigationStart,u.setStartTime(a),a>=0){for(r in f)c=f[r],typeof c=="number"&&c>0&&r!=="navigationStart"&&r!==h&&u.mark(r,c);_G.FCT&&u.mark("FN",_G.FCT);_G.BCT&&u.mark("BN",_G.BCT)}u.record("nav",h in f?f[h]:performance[h].type)}e="connection";l="";_w.navigator&&navigator[e]&&(l=',"net":"'.concat(navigator[e].type,'"'),navigator[e].downlinkMax&&(l+=',"dlMax":"'.concat(navigator[e].downlinkMax,'"')));o=_w.ChatMergeLogHelper;typeof o!="undefined"&&o&&typeof o.getBotRequestId=="function"&&(v=o.getBotRequestId());_G.PPImg=new Image;_G.PPImg.src=_G.lsUrl+'&Type=Event.CPT&DATA={"pp":{"S":"'+(t||"L")+'",'+s.join(",")+',"CT":'+(n-_G.ST)+',"IL":'+_d.images.length+"}"+(_G.C1?","+_G.C1:"")+l+(v?',"rid":"'+v+'"':"")+"}"+(_G.P?"&P="+_G.P:"")+(_G.DA?"&DA="+_G.DA:"")+(_G.MN?"&MN="+_G.MN:"");_G.PPS=1;sb_st(function(){u&&u.flush();sj_evt.fire("onPP");sj_evt.fire(_w.p1)},1)}};_w.onbeforeunload=function(){si_PP(new Date,"A")};sj_evt.bind("ajax.requestSent",function(){window.perf&&perf.reset()});
//]]></script><style id="video-roll-deg-scale" type="text/css">
                .video-roll-deg-scale {}
            </style><style id="video-roll-focus-style" type="text/css">#video-roll-root-mask {
                display: none;
                position: fixed;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                backdrop-filter: unset;
                z-index: 20000 !important;
                background-color: rgba(0, 0, 0, 0.9);
            }
            
            .video-roll-focus {
                width: undefinedpx;
                height: undefinedpx;
                position: absolute;
                left: 0;
                right: 0;
                top: 0;
                bottom: 0;
                margin: auto;
                border-radius: unset
            }</style><style>*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}:before,:after{--tw-content: ""}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:Ginto,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:CascadiaCode,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}:root{--color-inherit: inherit;--color-current: currentColor;--color-transparent: transparent;--color-black: #000;--color-white: #fff;--color-background-100: var(--color-background-100);--color-background-150: var(--color-background-150);--color-background-200: var(--color-background-200);--color-background-250: var(--color-background-250);--color-background-300: var(--color-background-300);--color-background-350: var(--color-background-350);--color-background-400: var(--color-background-400);--color-background-450: var(--color-background-450);--color-background-550: var(--color-background-550);--color-background-600: var(--color-background-600);--color-background-650: var(--color-background-650);--color-background-700: var(--color-background-700);--color-background-750: var(--color-background-750);--color-background-800: var(--color-background-800);--color-background-850: var(--color-background-850);--color-background-900: var(--color-background-900);--color-background-static-100: var(--color-background-static-100);--color-background-static-150: var(--color-background-static-150);--color-background-static-200: var(--color-background-static-200);--color-background-static-250: var(--color-background-static-250);--color-background-static-300: var(--color-background-static-300);--color-background-static-350: var(--color-background-static-350);--color-background-static-400: var(--color-background-static-400);--color-background-static-450: var(--color-background-static-450);--color-background-static-550: var(--color-background-static-550);--color-background-static-600: var(--color-background-static-600);--color-background-static-650: var(--color-background-static-650);--color-background-static-700: var(--color-background-static-700);--color-background-static-750: var(--color-background-static-750);--color-background-static-800: var(--color-background-static-800);--color-background-static-850: var(--color-background-static-850);--color-background-static-900: var(--color-background-static-900);--color-foreground-100: var(--color-foreground-100);--color-foreground-150: var(--color-foreground-150);--color-foreground-200: var(--color-foreground-200);--color-foreground-250: var(--color-foreground-250);--color-foreground-300: var(--color-foreground-300);--color-foreground-350: var(--color-foreground-350);--color-foreground-400: var(--color-foreground-400);--color-foreground-450: var(--color-foreground-450);--color-foreground-550: var(--color-foreground-550);--color-foreground-600: var(--color-foreground-600);--color-foreground-650: var(--color-foreground-650);--color-foreground-700: var(--color-foreground-700);--color-foreground-750: var(--color-foreground-750);--color-foreground-800: var(--color-foreground-800);--color-foreground-850: var(--color-foreground-850);--color-foreground-900: var(--color-foreground-900);--color-foreground-static-100: var(--color-foreground-static-100);--color-foreground-static-150: var(--color-foreground-static-150);--color-foreground-static-200: var(--color-foreground-static-200);--color-foreground-static-250: var(--color-foreground-static-250);--color-foreground-static-300: var(--color-foreground-static-300);--color-foreground-static-350: var(--color-foreground-static-350);--color-foreground-static-400: var(--color-foreground-static-400);--color-foreground-static-450: var(--color-foreground-static-450);--color-foreground-static-550: var(--color-foreground-static-550);--color-foreground-static-600: var(--color-foreground-static-600);--color-foreground-static-650: var(--color-foreground-static-650);--color-foreground-static-700: var(--color-foreground-static-700);--color-foreground-static-750: var(--color-foreground-static-750);--color-foreground-static-800: var(--color-foreground-static-800);--color-foreground-static-850: var(--color-foreground-static-850);--color-foreground-static-900: var(--color-foreground-static-900);--color-stroke-100: var(--color-stroke-100);--color-stroke-150: var(--color-stroke-150);--color-stroke-200: var(--color-stroke-200);--color-stroke-250: var(--color-stroke-250);--color-stroke-300: var(--color-stroke-300);--color-stroke-350: var(--color-stroke-350);--color-stroke-400: var(--color-stroke-400);--color-stroke-450: var(--color-stroke-450);--color-stroke-550: var(--color-stroke-550);--color-stroke-600: var(--color-stroke-600);--color-stroke-650: var(--color-stroke-650);--color-stroke-700: var(--color-stroke-700);--color-stroke-750: var(--color-stroke-750);--color-stroke-800: var(--color-stroke-800);--color-stroke-850: var(--color-stroke-850);--color-stroke-900: var(--color-stroke-900);--color-stroke-static-100: var(--color-stroke-static-100);--color-stroke-static-150: var(--color-stroke-static-150);--color-stroke-static-200: var(--color-stroke-static-200);--color-stroke-static-250: var(--color-stroke-static-250);--color-stroke-static-300: var(--color-stroke-static-300);--color-stroke-static-350: var(--color-stroke-static-350);--color-stroke-static-400: var(--color-stroke-static-400);--color-stroke-static-450: var(--color-stroke-static-450);--color-stroke-static-550: var(--color-stroke-static-550);--color-stroke-static-600: var(--color-stroke-static-600);--color-stroke-static-650: var(--color-stroke-static-650);--color-stroke-static-700: var(--color-stroke-static-700);--color-stroke-static-750: var(--color-stroke-static-750);--color-stroke-static-800: var(--color-stroke-static-800);--color-stroke-static-850: var(--color-stroke-static-850);--color-stroke-static-900: var(--color-stroke-static-900);--color-neutral-50: #ffffff;--color-neutral-100: #fcfcfc;--color-neutral-150: #fcfcfc;--color-neutral-200: #f1f1f1;--color-neutral-250: #e2e2e2;--color-neutral-300: #c6c6c6;--color-neutral-350: #ababab;--color-neutral-400: #909090;--color-neutral-450: #767676;--color-neutral-550: #5f5f5f;--color-neutral-600: #535353;--color-neutral-650: #474747;--color-neutral-700: #3b3b3b;--color-neutral-750: #303030;--color-neutral-800: #262626;--color-neutral-850: #1b1b1b;--color-neutral-900: #111111;--color-neutral-950: #000000;--color-midnight-100: #f8fcff;--color-midnight-150: #f5f7ff;--color-midnight-200: #e8ecff;--color-midnight-250: #cfdeff;--color-midnight-300: #b8c3f5;--color-midnight-350: #9da8d9;--color-midnight-400: #7f8dc4;--color-midnight-450: #6777af;--color-midnight-550: #4b5c92;--color-midnight-600: #3e5189;--color-midnight-650: #2c3a63;--color-midnight-700: #242f50;--color-midnight-750: #1d2439;--color-midnight-800: #171e32;--color-midnight-850: #101524;--color-midnight-900: #0c101c;--color-saddle-100: #fffdfb;--color-saddle-150: #fff9f4;--color-saddle-200: #ffedde;--color-saddle-250: #f2ddcc;--color-saddle-300: #e3cbbc;--color-saddle-350: #bba5a0;--color-saddle-400: #a2898c;--color-saddle-450: #867073;--color-saddle-550: #6d585b;--color-saddle-600: #604d4f;--color-saddle-650: #524144;--color-saddle-700: #463739;--color-saddle-750: #392d2e;--color-saddle-800: #2d2224;--color-saddle-850: #21191a;--color-saddle-900: #150f10;--color-salmon-100: #fefcfb;--color-salmon-150: #fdf8f6;--color-salmon-200: #fbede8;--color-salmon-250: #f7dbd1;--color-salmon-300: #efb7a1;--color-salmon-350: #e59472;--color-salmon-400: #c67a5b;--color-salmon-450: #ad6446;--color-salmon-550: #8a4b30;--color-salmon-600: #7c4026;--color-salmon-650: #6a3620;--color-salmon-700: #5a2d1a;--color-salmon-750: #4b2414;--color-salmon-800: #3b1c0e;--color-salmon-850: #2d1308;--color-salmon-900: #1e0b04;--color-slate-100: #f3f5f7;--color-slate-150: #f0f1f5;--color-slate-200: #e4e6f1;--color-slate-250: #cfd8ec;--color-slate-300: #b8bfdd;--color-slate-350: #9ea5c2;--color-slate-400: #828bac;--color-slate-450: #6b7597;--color-slate-550: #505b7b;--color-slate-600: #455172;--color-slate-650: #313a52;--color-slate-700: #282f42;--color-slate-750: #1f2330;--color-slate-800: #191d29;--color-slate-850: #11151d;--color-slate-900: #0d1017;--color-stone-100: #fefcfb;--color-stone-150: #f8f4f2;--color-stone-200: #f4efed;--color-stone-250: #e8e0dc;--color-stone-300: #ccc4c0;--color-stone-350: #b1aaa6;--color-stone-400: #968f8c;--color-stone-450: #7b7572;--color-stone-550: #635d5a;--color-stone-600: #57514f;--color-stone-650: #4a4543;--color-stone-700: #3e3a38;--color-stone-750: #33302e;--color-stone-800: #282523;--color-stone-850: #1d1b1a;--color-stone-900: #131110;--color-green-400: #4BA849;--color-blue-250: #cfeaf5;--color-blue-300: #b9e3f3;--color-blue-450: #0f92c6;--color-green-150: #f7fde5;--color-green-300: #94dc7f;--color-orange-300: #ffb352;--color-peach-100: #fcf7f2;--color-peach-150: #fdedde;--color-peach-200: #fee5ce;--color-peach-250: #fee0c3;--color-peach-300: #ffd2a7;--color-peach-350: #e3b388;--color-code-text: #fcfaf7;--color-code-comment: #aa9c87;--color-code-yellow: #ffc42f;--color-code-blue: #67abf1;--color-code-green: #00b360;--color-code-orange: #f96c00;--color-code-purple: #e3b5fa;--color-audio-blue: #b4d7ff;--color-audio-cyan: #b9fced;--color-link-350: #4d8dfa;--color-link-550: #235ccf;--color-green-350: #6fc366;--color-green-550: #127323;--color-red-350: #fa818b;--color-red-550: #993a45}@font-face{font-family:Ginto;src:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/fonts/Ginto-Copilot-Upright-Variable.woff2) format("woff2"),url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/fonts/Ginto-Copilot-Upright-Variable.woff) format("woff"),url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/fonts/Ginto-Copilot-Upright-Variable.ttf) format("ttf")}@font-face{font-family:CascadiaCode;src:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/fonts/CascadiaCode.woff2) format("woff2"),url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/fonts/CascadiaCode.ttf) format("ttf")}body{--tw-bg-opacity: 1;background-color:rgb(248 244 242 / var(--tw-bg-opacity));font-family:Ginto,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";color:var(--color-foreground-800);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-variation-settings:"opsz" 40,"wght" 410;font-size:1.0625rem;line-height:1.625rem}body bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}body strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}body:is([data-theme=dark] *){--tw-border-opacity: 1;border-color:rgb(16 21 36 / var(--tw-border-opacity))}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.\!container{width:100%!important}.container{width:100%}@media (min-width: 640px){.\!container{max-width:640px!important}.container{max-width:640px}}@media (min-width: 768px){.\!container{max-width:768px!important}.container{max-width:768px}}@media (min-width: 1024px){.\!container{max-width:1024px!important}.container{max-width:1024px}}@media (min-width: 1280px){.\!container{max-width:1280px!important}.container{max-width:1280px}}@media (min-width: 1536px){.\!container{max-width:1536px!important}.container{max-width:1536px}}.t-bottom-fade{-webkit-mask-image:linear-gradient(transparent 0px,black 6rem);mask-image:linear-gradient(transparent 0px,#000 6rem)}.t-table{width:100%;table-layout:auto;--tw-border-spacing-x: 0px;--tw-border-spacing-y: 0px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);font-variation-settings:"opsz" 40,"wght" 410;font-size:.9375rem;line-height:1.25rem}.t-table bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.t-table strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.t-table thead{--tw-bg-opacity: 1;background-color:rgb(255 237 222 / var(--tw-bg-opacity));color:var(--color-foreground-750);font-weight:650;font-variation-settings:"opsz" 40,"wght" 650;font-size:.9375rem;line-height:1.25rem}.t-table thead:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(23 30 50 / var(--tw-bg-opacity))}.t-table th{font-weight:500}.t-table th,.t-table td{border-width:1px;border-color:var(--color-stroke-300);padding:.625rem 1rem;text-align:left}.t-table th:is([data-theme=dark] *),.t-table td:is([data-theme=dark] *){border-color:var(--color-stroke-250)}.t-discover-card-large,.t-discover-card-small{border-image-width:96px;border-image-outset:0;border-image-repeat:stretch}.t-discover-card-large{border-image-slice:45% fill;border-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-container-large-light.svg)}[data-theme=dark] .t-discover-card-large{border-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-container-large-dark.svg)}.t-discover-card-small{border-image-slice:40% fill;border-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-container-small-light.svg)}[data-theme=dark] .t-discover-card-small{border-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-container-small-dark.svg)}.t-discover-background-image{-webkit-mask-box-image-width:104px;-webkit-mask-box-image-slice:48% fill;-webkit-mask-box-image-outset:0;-webkit-mask-box-image-repeat:stretch;-webkit-mask-box-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/squircle-mask-large.svg)}.t-discover-card-image{-webkit-mask-box-image-width:94px;-webkit-mask-box-image-slice:48% fill;-webkit-mask-box-image-outset:0;-webkit-mask-box-image-repeat:stretch}.t-discover-card-large .t-discover-card-image{-webkit-mask-box-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-image-large.svg)}.t-discover-card-small .t-discover-card-image{-webkit-mask-box-image-source:url(https://studiostaticassetsprod.azureedge.net/bundle-wpwa/images/card-image-small.svg)}@media (prefers-contrast: more){.t-discover-card-large,.t-discover-card-small{-o-border-image:none!important;border-image:none!important}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.-inset-16{top:-4rem;right:-4rem;bottom:-4rem;left:-4rem}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.bottom-0{bottom:0}.bottom-1\/3{bottom:33.333333%}.bottom-\[60px\]{bottom:60px}.end-0{inset-inline-end:0px}.end-0\.5{inset-inline-end:.125rem}.end-4{inset-inline-end:1rem}.end-6{inset-inline-end:1.5rem}.left-0{left:0}.left-2{left:.5rem}.left-4{left:1rem}.right-2{right:.5rem}.start-0{inset-inline-start:0px}.top-0{top:0}.top-0\.5{top:.125rem}.top-1\.5{top:.375rem}.top-4{top:1rem}.top-6{top:1.5rem}.top-\[93px\]{top:93px}.isolate{isolation:isolate}.-z-10{z-index:-10}.z-0{z-index:0}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.col-span-1{grid-column:span 1 / span 1}.col-span-2{grid-column:span 2 / span 2}.row-span-1{grid-row:span 1 / span 1}.row-span-2{grid-row:span 2 / span 2}.row-start-1{grid-row-start:1}.row-start-2{grid-row-start:2}.row-end-2{grid-row-end:2}.row-end-3{grid-row-end:3}.float-right{float:right}.m-1{margin:.25rem}.m-3{margin:.75rem}.m-auto{margin:auto}.mx-0\.5{margin-left:.125rem;margin-right:.125rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-1\.5{margin-left:.375rem;margin-right:.375rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-2\.5{margin-left:.625rem;margin-right:.625rem}.mx-3{margin-left:.75rem;margin-right:.75rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mx-px{margin-left:1px;margin-right:1px}.my-1{margin-top:.25rem;margin-bottom:.25rem}.my-1\.5{margin-top:.375rem;margin-bottom:.375rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-2\.5{margin-top:.625rem;margin-bottom:.625rem}.my-3{margin-top:.75rem;margin-bottom:.75rem}.my-6{margin-top:1.5rem;margin-bottom:1.5rem}.my-8{margin-top:2rem;margin-bottom:2rem}.-ms-2\.5{margin-inline-start:-.625rem}.-mt-2{margin-top:-.5rem}.mb-0{margin-bottom:0}.mb-1{margin-bottom:.25rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-6{margin-bottom:1.5rem}.mb-\[var\(--composer-container-height\)\]{margin-bottom:var(--composer-container-height)}.me-0\.5{margin-inline-end:.125rem}.me-1{margin-inline-end:.25rem}.me-2{margin-inline-end:.5rem}.mr-1{margin-right:.25rem}.mr-2{margin-right:.5rem}.ms-1{margin-inline-start:.25rem}.ms-2{margin-inline-start:.5rem}.ms-4{margin-inline-start:1rem}.ms-5{margin-inline-start:1.25rem}.ms-auto{margin-inline-start:auto}.mt-1{margin-top:.25rem}.mt-12{margin-top:3rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-px{margin-top:1px}.box-content{box-sizing:content-box}.line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.line-clamp-3{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3}.line-clamp-4{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:4}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.aspect-\[2\/1\]{aspect-ratio:2/1}.aspect-\[2\/3\]{aspect-ratio:2/3}.aspect-auto{aspect-ratio:auto}.aspect-square{aspect-ratio:1 / 1}.size-0\.5{width:.125rem;height:.125rem}.size-10{width:2.5rem;height:2.5rem}.size-11{width:2.75rem;height:2.75rem}.size-12{width:3rem;height:3rem}.size-14{width:3.5rem;height:3.5rem}.size-16{width:4rem;height:4rem}.size-3{width:.75rem;height:.75rem}.size-3\.5{width:.875rem;height:.875rem}.size-4{width:1rem;height:1rem}.size-5{width:1.25rem;height:1.25rem}.size-6{width:1.5rem;height:1.5rem}.size-7{width:1.75rem;height:1.75rem}.size-8{width:2rem;height:2rem}.size-9{width:2.25rem;height:2.25rem}.size-full{width:100%;height:100%}.size-min{width:-moz-min-content;width:min-content;height:-moz-min-content;height:min-content}.h-0{height:0px}.h-1{height:.25rem}.h-10{height:2.5rem}.h-12{height:3rem}.h-16{height:4rem}.h-3\.5{height:.875rem}.h-32{height:8rem}.h-4{height:1rem}.h-40{height:10rem}.h-44{height:11rem}.h-5{height:1.25rem}.h-52{height:13rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-9{height:2.25rem}.h-96{height:24rem}.h-\[100px\]{height:100px}.h-\[116px\]{height:116px}.h-\[188px\]{height:188px}.h-\[3px\]{height:3px}.h-\[424px\]{height:424px}.h-\[50px\]{height:50px}.h-\[549px\]{height:549px}.h-\[86px\]{height:86px}.h-\[88px\]{height:88px}.h-\[95px\]{height:95px}.h-auto{height:auto}.h-bottom-fade{height:calc(100% - 2rem)}.h-composer{height:4rem}.h-dvh{height:100dvh}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-screen{height:100vh}.max-h-128{max-height:32rem}.max-h-64{max-height:16rem}.max-h-96{max-height:24rem}.max-h-\[50\%\]{max-height:50%}.max-h-\[90vh\]{max-height:90vh}.max-h-\[calc\(100vh-5rem\)\]{max-height:calc(100vh - 5rem)}.max-h-dvh-0\.5{max-height:50dvh}.max-h-expanded-section{max-height:calc(100vh - 8rem)}.max-h-full{max-height:100%}.min-h-0{min-height:0px}.min-h-10{min-height:2.5rem}.min-h-12{min-height:3rem}.min-h-14{min-height:3.5rem}.min-h-16{min-height:4rem}.min-h-36{min-height:9rem}.min-h-6{min-height:1.5rem}.min-h-7{min-height:1.75rem}.min-h-8{min-height:2rem}.min-h-9{min-height:2.25rem}.min-h-\[150px\]{min-height:150px}.min-h-\[224px\]{min-height:224px}.min-h-\[60px\]{min-height:60px}.min-h-\[calc\(100dvh-60px-var\(--composer-container-height\)\)\]{min-height:calc(100dvh - 60px - var(--composer-container-height))}.min-h-composer{min-height:4rem}.min-h-user-input{min-height:1.625rem}.w-0{width:0px}.w-10{width:2.5rem}.w-24{width:6rem}.w-3\.5{width:.875rem}.w-3\/4{width:75%}.w-4{width:1rem}.w-5\/12{width:41.666667%}.w-60{width:15rem}.w-72{width:18rem}.w-8{width:2rem}.w-96{width:24rem}.w-\[1\.5ch\]{width:1.5ch}.w-\[128px\]{width:128px}.w-\[147px\]{width:147px}.w-\[163px\]{width:163px}.w-\[347px\]{width:347px}.w-\[5ch\]{width:5ch}.w-\[6ch\]{width:6ch}.w-\[700px\]{width:700px}.w-auto{width:auto}.w-bottom-fade{width:calc(100% - 2rem)}.w-daily-briefing{width:358px}.w-expanded-composer{width:min(calc(100vw - 1.5rem),46.5rem)}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-max{width:-moz-max-content;width:max-content}.w-min{width:-moz-min-content;width:min-content}.w-prompt-sign-in{width:360px}.w-screen{width:100vw}.w-settings{width:278px}.min-w-0{min-width:0px}.min-w-10{min-width:2.5rem}.min-w-12{min-width:3rem}.min-w-14{min-width:3.5rem}.min-w-16{min-width:4rem}.min-w-4{min-width:1rem}.min-w-40{min-width:10rem}.min-w-44{min-width:11rem}.min-w-60{min-width:15rem}.min-w-8{min-width:2rem}.min-w-9{min-width:2.25rem}.min-w-96{min-width:24rem}.min-w-\[250px\]{min-width:250px}.min-w-conversations{min-width:min(calc(100vw - 1.5rem),24rem)}.max-w-0{max-width:0px}.max-w-3xl{max-width:48rem}.max-w-40{max-width:10rem}.max-w-72{max-width:18rem}.max-w-96{max-width:24rem}.max-w-\[220px\]{max-width:220px}.max-w-\[80\%\]{max-width:80%}.max-w-\[min\(80\%\,256px\)\]{max-width:min(80%,256px)}.max-w-chat{max-width:min(100%,46.5rem)}.max-w-cookie-banner{max-width:52.5rem}.max-w-discover{max-width:54rem}.max-w-fit{max-width:-moz-fit-content;max-width:fit-content}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-xl{max-width:36rem}.max-w-xs{max-width:20rem}.flex-1{flex:1 1 0%}.shrink{flex-shrink:1}.shrink-0{flex-shrink:0}.grow{flex-grow:1}.grow-\[15\]{flex-grow:15}.origin-bottom{transform-origin:bottom}.origin-top-left{transform-origin:top left}.-rotate-90{--tw-rotate: -90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-45{--tw-rotate: 45deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-scale-x-100{--tw-scale-x: -1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.animate-spin-slow{animation:spin 2.5s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin-slower{animation:spin 5s linear infinite}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.cursor-text{cursor:text}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize-none{resize:none}.resize{resize:both}.list-outside{list-style-position:outside}.list-disc{list-style-type:disc}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.grid-rows-\[1fr_1fr_1fr\]{grid-template-rows:1fr 1fr 1fr}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.place-content-center{place-content:center}.place-items-center{place-items:center}.content-center{align-content:center}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.justify-stretch{justify-content:stretch}.justify-items-start{justify-items:start}.justify-items-center{justify-items:center}.gap-0\.5{gap:.125rem}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-14{gap:3.5rem}.gap-2{gap:.5rem}.gap-2\.5{gap:.625rem}.gap-3{gap:.75rem}.gap-3\.5{gap:.875rem}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-6{gap:1.5rem}.gap-x-1{-moz-column-gap:.25rem;column-gap:.25rem}.gap-x-1\.5{-moz-column-gap:.375rem;column-gap:.375rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.gap-x-3{-moz-column-gap:.75rem;column-gap:.75rem}.gap-x-4{-moz-column-gap:1rem;column-gap:1rem}.gap-x-5{-moz-column-gap:1.25rem;column-gap:1.25rem}.gap-x-8{-moz-column-gap:2rem;column-gap:2rem}.gap-y-1{row-gap:.25rem}.gap-y-2{row-gap:.5rem}.gap-y-4{row-gap:1rem}.gap-y-6{row-gap:1.5rem}.gap-y-9{row-gap:2.25rem}.space-y-0\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.125rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.125rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.self-start{align-self:flex-start}.self-end{align-self:flex-end}.self-center{align-self:center}.justify-self-start{justify-self:start}.justify-self-end{justify-self:end}.justify-self-center{justify-self:center}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.overflow-y-hidden{overflow-y:hidden}.overflow-x-scroll{overflow-x:scroll}.overscroll-contain{overscroll-behavior:contain}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.whitespace-pre{white-space:pre}.whitespace-pre-wrap{white-space:pre-wrap}.text-balance{text-wrap:balance}.text-pretty{text-wrap:pretty}.break-words{overflow-wrap:break-word}.break-all{word-break:break-all}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.25rem}.rounded-4xl{border-radius:1.5rem}.rounded-5xl{border-radius:1.75rem}.rounded-6xl{border-radius:2rem}.rounded-7xl{border-radius:3rem}.rounded-8xl{border-radius:4rem}.rounded-\[4px\]{border-radius:4px}.rounded-\[8\.5px\]{border-radius:8.5px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-sm{border-radius:.125rem}.rounded-submitButton{border-radius:.875rem}.rounded-xl{border-radius:.75rem}.rounded-b-5xl{border-bottom-right-radius:1.75rem;border-bottom-left-radius:1.75rem}.rounded-b-xl{border-bottom-right-radius:.75rem;border-bottom-left-radius:.75rem}.rounded-t-3xl{border-top-left-radius:1.25rem;border-top-right-radius:1.25rem}.rounded-t-7xl{border-top-left-radius:3rem;border-top-right-radius:3rem}.rounded-t-xl{border-top-left-radius:.75rem;border-top-right-radius:.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-b-\[0\.5px\]{border-bottom-width:.5px}.border-t{border-top-width:1px}.border-t-\[0\.5px\]{border-top-width:.5px}.border-solid{border-style:solid}.border-black\/10{border-color:#0000001a}.border-black\/15{border-color:#00000026}.border-black\/20{border-color:#0003}.border-black\/5{border-color:#0000000d}.border-black\/8{border-color:#00000014}.border-foreground-800{border-color:var(--color-foreground-800)}.border-saddle-300{--tw-border-opacity: 1;border-color:rgb(227 203 188 / var(--tw-border-opacity))}.border-stroke-100{border-color:var(--color-stroke-100)}.border-stroke-200{border-color:var(--color-stroke-200)}.border-stroke-250{border-color:var(--color-stroke-250)}.border-stroke-300{border-color:var(--color-stroke-300)}.border-stroke-350{border-color:var(--color-stroke-350)}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity))}.border-white\/10{border-color:#ffffff1a}.border-white\/20{border-color:#fff3}.border-b-black\/20{border-bottom-color:#0003}.bg-\[color\:var\(--foreground-color\)\]{background-color:var(--foreground-color)}.bg-background-100{background-color:var(--color-background-100)}.bg-background-200{background-color:var(--color-background-200)}.bg-background-250{background-color:var(--color-background-250)}.bg-background-300{background-color:var(--color-background-300)}.bg-background-900{background-color:var(--color-background-900)}.bg-background-static-250{background-color:var(--color-background-static-250)}.bg-background-static-850{background-color:var(--color-background-static-850)}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity))}.bg-black\/20{background-color:#0003}.bg-black\/3{background-color:#00000008}.bg-black\/30{background-color:#0000004d}.bg-black\/5{background-color:#0000000d}.bg-black\/50{background-color:#00000080}.bg-black\/8{background-color:#00000014}.bg-foreground-200{background-color:var(--color-foreground-200)}.bg-green-400{--tw-bg-opacity: 1;background-color:rgb(75 168 73 / var(--tw-bg-opacity))}.bg-neutral-200{--tw-bg-opacity: 1;background-color:rgb(241 241 241 / var(--tw-bg-opacity))}.bg-spot-peach-200\/50{background-color:#fee5ce80}.bg-spot-peach-300{--tw-bg-opacity: 1;background-color:rgb(255 210 167 / var(--tw-bg-opacity))}.bg-spot-peach-300\/50{background-color:#ffd2a780}.bg-spot-peach-300\/60{background-color:#ffd2a799}.bg-stone-100\/30{background-color:#fefcfb4d}.bg-stone-150{--tw-bg-opacity: 1;background-color:rgb(248 244 242 / var(--tw-bg-opacity))}.bg-stone-200{--tw-bg-opacity: 1;background-color:rgb(244 239 237 / var(--tw-bg-opacity))}.bg-stone-750{--tw-bg-opacity: 1;background-color:rgb(51 48 46 / var(--tw-bg-opacity))}.bg-stone-800{--tw-bg-opacity: 1;background-color:rgb(40 37 35 / var(--tw-bg-opacity))}.bg-stone-850\/30{background-color:#1d1b1a4d}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.bg-white\/25{background-color:#ffffff40}.bg-white\/30{background-color:#ffffff4d}.bg-white\/40{background-color:#fff6}.bg-white\/50{background-color:#ffffff80}.bg-white\/70{background-color:#ffffffb3}.bg-white\/80{background-color:#fffc}.bg-white\/90{background-color:#ffffffe6}.bg-gradient-audio-input-light{background-image:linear-gradient(180deg,#b4d7ff,#b9fced)}.bg-gradient-audio-output-light{background-image:linear-gradient(180deg,#b4d7ff 30%,#b9fced 80%)}.bg-gradient-chat-light{background-image:linear-gradient(180deg,#f8f4f2 50%,#fdedde)}.bg-gradient-discover-light{background-image:linear-gradient(180deg,#f8f4f2,#fdedde)}.bg-gradient-to-t{background-image:linear-gradient(to top,var(--tw-gradient-stops))}.from-\[var\(--background-color\)\]{--tw-gradient-from: var(--background-color) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.via-\[color\:var\(--background-color\)\]{--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--background-color) var(--tw-gradient-via-position), var(--tw-gradient-to)}.via-40\%{--tw-gradient-via-position: 40%}.via-45\%{--tw-gradient-via-position: 45%}.to-\[transparent\]{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.fill-black{fill:#000}.fill-foreground-100{fill:var(--color-foreground-100)}.fill-foreground-250{fill:var(--color-foreground-250)}.fill-foreground-600{fill:var(--color-foreground-600)}.fill-foreground-750{fill:var(--color-foreground-750)}.fill-foreground-800{fill:var(--color-foreground-800)}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-0\.5{padding-left:.125rem;padding-right:.125rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-7{padding-left:1.75rem;padding-right:1.75rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0{padding-top:0;padding-bottom:0}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-2\.5{padding-top:.625rem;padding-bottom:.625rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-3\.5{padding-top:.875rem;padding-bottom:.875rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-7{padding-top:1.75rem;padding-bottom:1.75rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-\[1\.5px\]{padding-top:1.5px;padding-bottom:1.5px}.py-px{padding-top:1px;padding-bottom:1px}.py-user-input{padding-top:.6875rem;padding-bottom:.6875rem}.pb-0{padding-bottom:0}.pb-0\.5{padding-bottom:.125rem}.pb-1{padding-bottom:.25rem}.pb-1\.5{padding-bottom:.375rem}.pb-10{padding-bottom:2.5rem}.pb-16{padding-bottom:4rem}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pb-36{padding-bottom:9rem}.pb-4{padding-bottom:1rem}.pb-5{padding-bottom:1.25rem}.pb-6{padding-bottom:1.5rem}.pb-7{padding-bottom:1.75rem}.pb-8{padding-bottom:2rem}.pb-9{padding-bottom:2.25rem}.pe-1{padding-inline-end:.25rem}.pe-2{padding-inline-end:.5rem}.pe-2\.5{padding-inline-end:.625rem}.pe-3{padding-inline-end:.75rem}.pe-4{padding-inline-end:1rem}.pe-8{padding-inline-end:2rem}.pl-1{padding-left:.25rem}.pl-12{padding-left:3rem}.pl-2\.5{padding-left:.625rem}.pl-3{padding-left:.75rem}.pl-4{padding-left:1rem}.pr-12{padding-right:3rem}.ps-1{padding-inline-start:.25rem}.ps-2{padding-inline-start:.5rem}.ps-3{padding-inline-start:.75rem}.ps-4{padding-inline-start:1rem}.ps-6{padding-inline-start:1.5rem}.pt-1{padding-top:.25rem}.pt-10{padding-top:2.5rem}.pt-2{padding-top:.5rem}.pt-24{padding-top:6rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.pt-7{padding-top:1.75rem}.pt-bottom-fade{padding-top:6rem}.pt-px{padding-top:1px}.text-center{text-align:center}.text-right{text-align:right}.text-start{text-align:start}.text-end{text-align:end}.indent-0{text-indent:0px}.align-middle{vertical-align:middle}.font-mono{font-family:CascadiaCode,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:Ginto,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.text-\[12px\]{font-size:12px}.font-bold{font-weight:700}.font-extralight{font-weight:200}.font-light{font-weight:300}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.lowercase{text-transform:lowercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.leading-4{line-height:1rem}.text-\[color\:var\(--background-color\)\]{color:var(--background-color)}.text-\[color\:var\(--foreground-color\)\]{color:var(--foreground-color)}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity))}.text-black\/40{color:#0006}.text-black\/80{color:#000c}.text-foreground-250{color:var(--color-foreground-250)}.text-foreground-450{color:var(--color-foreground-450)}.text-foreground-550{color:var(--color-foreground-550)}.text-foreground-600{color:var(--color-foreground-600)}.text-foreground-650{color:var(--color-foreground-650)}.text-foreground-700{color:var(--color-foreground-700)}.text-foreground-750{color:var(--color-foreground-750)}.text-foreground-800{color:var(--color-foreground-800)}.text-foreground-850{color:var(--color-foreground-850)}.text-foreground-900{color:var(--color-foreground-900)}.text-foreground-static-250{color:var(--color-foreground-static-250)}.text-link-550{--tw-text-opacity: 1;color:rgb(35 92 207 / var(--tw-text-opacity))}.text-midnight-450{--tw-text-opacity: 1;color:rgb(103 119 175 / var(--tw-text-opacity))}.text-neutral-400{--tw-text-opacity: 1;color:rgb(144 144 144 / var(--tw-text-opacity))}.text-neutral-450{--tw-text-opacity: 1;color:rgb(118 118 118 / var(--tw-text-opacity))}.text-neutral-900{--tw-text-opacity: 1;color:rgb(17 17 17 / var(--tw-text-opacity))}.text-salmon-550{--tw-text-opacity: 1;color:rgb(138 75 48 / var(--tw-text-opacity))}.text-salmon-600{--tw-text-opacity: 1;color:rgb(124 64 38 / var(--tw-text-opacity))}.text-spot-blue-450{--tw-text-opacity: 1;color:rgb(15 146 198 / var(--tw-text-opacity))}.text-stone-450{--tw-text-opacity: 1;color:rgb(123 117 114 / var(--tw-text-opacity))}.text-stone-550{--tw-text-opacity: 1;color:rgb(99 93 90 / var(--tw-text-opacity))}.text-stone-550\/90{color:#635d5ae6}.text-stone-750{--tw-text-opacity: 1;color:rgb(51 48 46 / var(--tw-text-opacity))}.text-stone-800{--tw-text-opacity: 1;color:rgb(40 37 35 / var(--tw-text-opacity))}.text-stone-900{--tw-text-opacity: 1;color:rgb(19 17 16 / var(--tw-text-opacity))}.text-system-red-550{--tw-text-opacity: 1;color:rgb(153 58 69 / var(--tw-text-opacity))}.underline{text-decoration-line:underline}.line-through{text-decoration-line:line-through}.opacity-0{opacity:0}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-40{opacity:.4}.opacity-90{opacity:.9}.bg-blend-saturation{background-blend-mode:saturation}.bg-blend-luminosity{background-blend-mode:luminosity}.shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-button-light{--tw-shadow: 0px 1px 3px 0px rgba(0, 0, 0, .2), 0px .5px .5px .5px #ffffff inset;--tw-shadow-colored: 0px 1px 3px 0px var(--tw-shadow-color), inset 0px .5px .5px .5px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-button-strong-light{--tw-shadow: 0px 1px 3px 0px rgba(0, 0, 0, .2);--tw-shadow-colored: 0px 1px 3px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-composer-input{--tw-shadow: 0px 2px 16px 0px rgba(0, 0, 0, .04);--tw-shadow-colored: 0px 2px 16px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-inner{--tw-shadow: inset 0 2px 4px 0 rgb(0 0 0 / .05);--tw-shadow-colored: inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.outline-2{outline-width:2px}.outline-offset-1{outline-offset:1px}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-\[6px\]{--tw-blur: blur(6px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.blur-lg{--tw-blur: blur(16px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale: grayscale(100%);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.saturate-150{--tw-saturate: saturate(1.5);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-2xl{--tw-backdrop-blur: blur(40px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-\[10px\]{--tw-backdrop-blur: blur(10px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-xl{--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-saturate-200{--tw-backdrop-saturate: saturate(2);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in{transition-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.text-3xs{font-size:.625rem;line-height:.875rem;font-variation-settings:"opsz" 40,"wght" 600}.text-3xs bold{font-weight:800;font-variation-settings:"opsz" 40,"wght" 800}.text-3xs strong{font-weight:800;font-variation-settings:"opsz" 40,"wght" 800}.text-2xs{font-size:.75rem;line-height:1rem;font-variation-settings:"opsz" 40,"wght" 450}.text-2xs bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-2xs strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xs{font-size:.875rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 410}.text-xs bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xs strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xs-strong{font-weight:650;font-size:.875rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 650}.text-sm{font-size:.9375rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 410}.text-sm bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-sm strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-sm-strong{font-weight:650;font-size:.9375rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 650}.text-base{font-size:1.0625rem;line-height:1.625rem;font-variation-settings:"opsz" 40,"wght" 410}.text-base bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-base strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-base-strong{font-weight:650;font-size:1.0625rem;line-height:1.625rem;font-variation-settings:"opsz" 40,"wght" 650}.text-base-dense{font-size:1.0625rem;line-height:1.375rem;font-variation-settings:"opsz" 40,"wght" 410}.text-base-dense bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-base-dense strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-md{font-size:1.25rem;line-height:1.625rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 460}.text-md bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-md strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-md-strong{font-weight:650;font-size:1.25rem;line-height:1.625rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 650}.text-lg{font-size:1.5rem;line-height:1.9375rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 440}.text-lg bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-lg strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-lg-strong{font-weight:650;font-size:1.5rem;line-height:1.9375rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 650}.text-xl{font-size:1.75rem;line-height:2rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 480}.text-xl bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xl strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-2xl{font-size:2.375rem;line-height:2.5rem;letter-spacing:-.02em;font-variation-settings:"opsz" 40,"wght" 480}.text-2xl bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-2xl strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-sm-e{font-size:.9375rem;line-height:1.425rem;font-variation-settings:"opsz" 40,"wght" 410}.text-sm-e bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-sm-e strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xl-e{font-size:2rem;line-height:2.25rem;letter-spacing:-.02em;font-variation-settings:"opsz" 40,"wght" 480}.text-xl-e bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.text-xl-e strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}html,body,#app{height:100%;overscroll-behavior:none}:root{--color-background-100: var(--color-stone-100);--color-background-150: var(--color-stone-150);--color-background-200: var(--color-stone-200);--color-background-250: var(--color-stone-250);--color-background-300: var(--color-stone-300);--color-background-350: var(--color-stone-350);--color-background-400: var(--color-stone-400);--color-background-450: var(--color-stone-450);--color-background-550: var(--color-stone-550);--color-background-600: var(--color-stone-600);--color-background-650: var(--color-stone-650);--color-background-700: var(--color-stone-700);--color-background-750: var(--color-stone-750);--color-background-800: var(--color-stone-800);--color-background-850: var(--color-stone-850);--color-background-900: var(--color-stone-900);--color-background-static-100: var(--color-stone-100);--color-background-static-150: var(--color-stone-150);--color-background-static-200: var(--color-stone-200);--color-background-static-250: var(--color-stone-250);--color-background-static-300: var(--color-stone-300);--color-background-static-350: var(--color-stone-350);--color-background-static-400: var(--color-stone-400);--color-background-static-450: var(--color-stone-450);--color-background-static-550: var(--color-stone-550);--color-background-static-600: var(--color-stone-600);--color-background-static-650: var(--color-stone-650);--color-background-static-700: var(--color-stone-700);--color-background-static-750: var(--color-stone-750);--color-background-static-800: var(--color-stone-800);--color-background-static-850: var(--color-stone-850);--color-background-static-900: var(--color-stone-900);--color-foreground-100: var(--color-stone-100);--color-foreground-150: var(--color-stone-150);--color-foreground-200: var(--color-stone-200);--color-foreground-250: var(--color-stone-250);--color-foreground-300: var(--color-stone-300);--color-foreground-350: var(--color-stone-350);--color-foreground-400: var(--color-stone-400);--color-foreground-450: var(--color-stone-450);--color-foreground-550: var(--color-stone-550);--color-foreground-600: var(--color-stone-600);--color-foreground-650: var(--color-stone-650);--color-foreground-700: var(--color-stone-700);--color-foreground-750: var(--color-stone-750);--color-foreground-800: var(--color-stone-800);--color-foreground-850: var(--color-stone-850);--color-foreground-900: var(--color-stone-900);--color-foreground-static-100: var(--color-stone-100);--color-foreground-static-150: var(--color-stone-150);--color-foreground-static-200: var(--color-stone-200);--color-foreground-static-250: var(--color-stone-250);--color-foreground-static-300: var(--color-stone-300);--color-foreground-static-350: var(--color-stone-350);--color-foreground-static-400: var(--color-stone-400);--color-foreground-static-450: var(--color-stone-450);--color-foreground-static-550: var(--color-stone-550);--color-foreground-static-600: var(--color-stone-600);--color-foreground-static-650: var(--color-stone-650);--color-foreground-static-700: var(--color-stone-700);--color-foreground-static-750: var(--color-stone-750);--color-foreground-static-800: var(--color-stone-800);--color-foreground-static-850: var(--color-stone-850);--color-foreground-static-900: var(--color-stone-900);--color-stroke-100: var(--color-saddle-100);--color-stroke-150: var(--color-saddle-150);--color-stroke-200: var(--color-saddle-200);--color-stroke-250: var(--color-saddle-250);--color-stroke-300: var(--color-saddle-300);--color-stroke-350: var(--color-saddle-350);--color-stroke-400: var(--color-saddle-400);--color-stroke-450: var(--color-saddle-450);--color-stroke-550: var(--color-saddle-550);--color-stroke-600: var(--color-saddle-600);--color-stroke-650: var(--color-saddle-650);--color-stroke-700: var(--color-saddle-700);--color-stroke-750: var(--color-saddle-750);--color-stroke-800: var(--color-saddle-800);--color-stroke-850: var(--color-saddle-850);--color-stroke-900: var(--color-saddle-900);--color-stroke-static-100: var(--color-saddle-100);--color-stroke-static-150: var(--color-saddle-150);--color-stroke-static-200: var(--color-saddle-200);--color-stroke-static-250: var(--color-saddle-250);--color-stroke-static-300: var(--color-saddle-300);--color-stroke-static-350: var(--color-saddle-350);--color-stroke-static-400: var(--color-saddle-400);--color-stroke-static-450: var(--color-saddle-450);--color-stroke-static-550: var(--color-saddle-550);--color-stroke-static-600: var(--color-saddle-600);--color-stroke-static-650: var(--color-saddle-650);--color-stroke-static-700: var(--color-saddle-700);--color-stroke-static-750: var(--color-saddle-750);--color-stroke-static-800: var(--color-saddle-800);--color-stroke-static-850: var(--color-saddle-850);--color-stroke-static-900: var(--color-saddle-900)}[data-theme=dark]{--color-background-100: var(--color-midnight-900);--color-background-150: var(--color-midnight-850);--color-background-200: var(--color-midnight-800);--color-background-250: var(--color-midnight-750);--color-background-300: var(--color-midnight-700);--color-background-350: var(--color-midnight-650);--color-background-400: var(--color-midnight-600);--color-background-450: var(--color-midnight-550);--color-background-550: var(--color-midnight-450);--color-background-600: var(--color-midnight-400);--color-background-650: var(--color-midnight-350);--color-background-700: var(--color-midnight-300);--color-background-750: var(--color-midnight-250);--color-background-800: var(--color-midnight-200);--color-background-850: var(--color-midnight-150);--color-background-900: var(--color-midnight-100);--color-background-static-100: var(--color-midnight-100);--color-background-static-150: var(--color-midnight-150);--color-background-static-200: var(--color-midnight-200);--color-background-static-250: var(--color-midnight-250);--color-background-static-300: var(--color-midnight-300);--color-background-static-350: var(--color-midnight-350);--color-background-static-400: var(--color-midnight-400);--color-background-static-450: var(--color-midnight-450);--color-background-static-550: var(--color-midnight-550);--color-background-static-600: var(--color-midnight-600);--color-background-static-650: var(--color-midnight-650);--color-background-static-700: var(--color-midnight-700);--color-background-static-750: var(--color-midnight-750);--color-background-static-800: var(--color-midnight-800);--color-background-static-850: var(--color-midnight-850);--color-background-static-900: var(--color-midnight-900);--color-foreground-100: var(--color-saddle-900);--color-foreground-150: var(--color-saddle-850);--color-foreground-200: var(--color-saddle-800);--color-foreground-250: var(--color-saddle-750);--color-foreground-300: var(--color-saddle-700);--color-foreground-350: var(--color-saddle-650);--color-foreground-400: var(--color-saddle-600);--color-foreground-450: var(--color-saddle-550);--color-foreground-550: var(--color-saddle-550);--color-foreground-600: var(--color-saddle-450);--color-foreground-650: var(--color-saddle-400);--color-foreground-700: var(--color-saddle-350);--color-foreground-750: var(--color-saddle-300);--color-foreground-800: var(--color-saddle-250);--color-foreground-850: var(--color-saddle-200);--color-foreground-900: var(--color-saddle-150);--color-foreground-static-100: var(--color-saddle-100);--color-foreground-static-150: var(--color-saddle-150);--color-foreground-static-200: var(--color-saddle-200);--color-foreground-static-250: var(--color-saddle-250);--color-foreground-static-300: var(--color-saddle-300);--color-foreground-static-350: var(--color-saddle-350);--color-foreground-static-400: var(--color-saddle-400);--color-foreground-static-450: var(--color-saddle-450);--color-foreground-static-550: var(--color-saddle-550);--color-foreground-static-600: var(--color-saddle-600);--color-foreground-static-650: var(--color-saddle-650);--color-foreground-static-700: var(--color-saddle-700);--color-foreground-static-750: var(--color-saddle-750);--color-foreground-static-800: var(--color-saddle-800);--color-foreground-static-850: var(--color-saddle-850);--color-foreground-static-900: var(--color-saddle-900);--color-stroke-100: var(--color-slate-900);--color-stroke-150: var(--color-slate-850);--color-stroke-200: var(--color-slate-800);--color-stroke-250: var(--color-slate-750);--color-stroke-300: var(--color-slate-700);--color-stroke-350: var(--color-slate-650);--color-stroke-400: var(--color-slate-600);--color-stroke-450: var(--color-slate-550);--color-stroke-550: var(--color-slate-450);--color-stroke-600: var(--color-slate-400);--color-stroke-650: var(--color-slate-350);--color-stroke-700: var(--color-slate-300);--color-stroke-750: var(--color-slate-250);--color-stroke-800: var(--color-slate-200);--color-stroke-850: var(--color-slate-150);--color-stroke-900: var(--color-slate-100);--color-stroke-static-100: var(--color-slate-100);--color-stroke-static-150: var(--color-slate-150);--color-stroke-static-200: var(--color-slate-200);--color-stroke-static-250: var(--color-slate-250);--color-stroke-static-300: var(--color-slate-300);--color-stroke-static-350: var(--color-slate-350);--color-stroke-static-400: var(--color-slate-400);--color-stroke-static-450: var(--color-slate-450);--color-stroke-static-550: var(--color-slate-550);--color-stroke-static-600: var(--color-slate-600);--color-stroke-static-650: var(--color-slate-650);--color-stroke-static-700: var(--color-slate-700);--color-stroke-static-750: var(--color-slate-750);--color-stroke-static-800: var(--color-slate-800);--color-stroke-static-850: var(--color-slate-850);--color-stroke-static-900: var(--color-slate-900)}ol,ul{margin-top:.75rem;gap:.5rem}ol ol,ol ul,ul ul,ul ol{margin-bottom:.5rem;margin-top:.375rem;gap:.375rem}ol{list-style-type:decimal}ol ol{list-style:lower-alpha}ol ol ol{margin-bottom:0;list-style-type:disc}ol ol ol ol{list-style:circle}ul{list-style-type:disc}ul ul{list-style:circle}.code-block-scrollbar::-webkit-scrollbar{height:3px}.language-scrollbar::-webkit-scrollbar{width:3px}.language-scrollbar::-webkit-scrollbar-thumb,.code-block-scrollbar::-webkit-scrollbar-thumb{border-radius:.75rem;background-color:var(--color-stroke-400)}.ocv-feedback-dialog-responsive-height-container,.ocv-feedback-dialog-responsive-height-container .ms-TextField-field{border-radius:.75rem}.ocv-feedback-dialog-responsive-height-container .ms-TextField-field{background-color:var(--color-background-200)}.no-scrollbar::-webkit-scrollbar{display:none}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.scrollbar-container::-webkit-scrollbar{width:12px;visibility:hidden;background:transparent}.scrollbar-container::-webkit-scrollbar-thumb{background-color:#00000073;border-radius:8px;visibility:hidden;background-clip:content-box;border:4px solid transparent}.scrollbar-container:hover::-webkit-scrollbar-thumb{visibility:visible}.scrollbar-container::-webkit-scrollbar-thumb:hover{background-color:#0000009c}.scrollbar-container::-webkit-scrollbar-thumb:active{background-color:#0000009e}.scrollbar-container:hover::-webkit-scrollbar-track{visibility:hidden}.text-synthesis-none{font-synthesis:none!important}@media (prefers-color-scheme: dark){.scrollbar-container::-webkit-scrollbar{background-color:#ffffff8c}.scrollbar-container::-webkit-scrollbar-thumb{background-color:#ffffff73}.scrollbar-container::-webkit-scrollbar-thumb:hover{background-color:#ffffff9c}.scrollbar-container::-webkit-scrollbar-thumb:active{background-color:#ffffff9e}}.marker\:normal-nums *::marker{font-variant-numeric:normal}.marker\:text-foreground-750 *::marker{color:var(--color-foreground-750)}.marker\:text-sm-strong *::marker{font-weight:650;font-size:.9375rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 650}.marker\:normal-nums::marker{font-variant-numeric:normal}.marker\:text-foreground-750::marker{color:var(--color-foreground-750)}.marker\:text-sm-strong::marker{font-weight:650;font-size:.9375rem;line-height:1.25rem;font-variation-settings:"opsz" 40,"wght" 650}.placeholder\:text-center::-moz-placeholder{text-align:center}.placeholder\:text-center::placeholder{text-align:center}.placeholder\:text-stone-550::-moz-placeholder{--tw-text-opacity: 1;color:rgb(99 93 90 / var(--tw-text-opacity))}.placeholder\:text-stone-550::placeholder{--tw-text-opacity: 1;color:rgb(99 93 90 / var(--tw-text-opacity))}.placeholder\:text-stone-550\/90::-moz-placeholder{color:#635d5ae6}.placeholder\:text-stone-550\/90::placeholder{color:#635d5ae6}.before\:pointer-events-none:before{content:var(--tw-content);pointer-events:none}.before\:absolute:before{content:var(--tw-content);position:absolute}.before\:inset-0:before{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.before\:inset-x-px:before{content:var(--tw-content);left:1px;right:1px}.before\:-top-0:before{content:var(--tw-content);top:-0px}.before\:bottom-0\.5:before{content:var(--tw-content);bottom:.125rem}.before\:rounded-2xl:before{content:var(--tw-content);border-radius:1rem}.before\:rounded-3xl:before{content:var(--tw-content);border-radius:1.25rem}.before\:rounded-4xl:before{content:var(--tw-content);border-radius:1.5rem}.before\:rounded-7xl:before{content:var(--tw-content);border-radius:3rem}.before\:rounded-8xl:before{content:var(--tw-content);border-radius:4rem}.before\:rounded-full:before{content:var(--tw-content);border-radius:9999px}.before\:rounded-lg:before{content:var(--tw-content);border-radius:.5rem}.before\:rounded-xl:before{content:var(--tw-content);border-radius:.75rem}.before\:border:before{content:var(--tw-content);border-width:1px}.before\:border-2:before{content:var(--tw-content);border-width:2px}.before\:border-stroke-350:before{content:var(--tw-content);border-color:var(--color-stroke-350)}.before\:border-transparent:before{content:var(--tw-content);border-color:transparent}.before\:bg-slate-200:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(228 230 241 / var(--tw-bg-opacity))}.before\:bg-stone-200:before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(244 239 237 / var(--tw-bg-opacity))}.before\:opacity-0:before{content:var(--tw-content);opacity:0}.before\:opacity-100:before{content:var(--tw-content);opacity:1}.before\:opacity-30:before{content:var(--tw-content);opacity:.3}.before\:opacity-40:before{content:var(--tw-content);opacity:.4}.before\:bg-blend-luminosity:before{content:var(--tw-content);background-blend-mode:luminosity}.before\:delay-100:before{content:var(--tw-content);transition-delay:.1s}.before\:duration-200:before{content:var(--tw-content);transition-duration:.2s}.after\:absolute:after{content:var(--tw-content);position:absolute}.after\:-inset-px:after{content:var(--tw-content);top:-1px;right:-1px;bottom:-1px;left:-1px}.after\:inset-0:after{content:var(--tw-content);top:0;right:0;bottom:0;left:0}.after\:inset-px:after{content:var(--tw-content);top:1px;right:1px;bottom:1px;left:1px}.after\:start-\[2px\]:after{content:var(--tw-content);inset-inline-start:2px}.after\:top-\[2px\]:after{content:var(--tw-content);top:2px}.after\:mt-3:after{content:var(--tw-content);margin-top:.75rem}.after\:size-5:after{content:var(--tw-content);width:1.25rem;height:1.25rem}.after\:w-full:after{content:var(--tw-content);width:100%}.after\:translate-x-4:after{content:var(--tw-content);--tw-translate-x: 1rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.after\:rounded-6xl:after{content:var(--tw-content);border-radius:2rem}.after\:rounded-full:after{content:var(--tw-content);border-radius:9999px}.after\:rounded-lg:after{content:var(--tw-content);border-radius:.5rem}.after\:border:after{content:var(--tw-content);border-width:1px}.after\:border-2:after{content:var(--tw-content);border-width:2px}.after\:border-\[0\.5px\]:after{content:var(--tw-content);border-width:.5px}.after\:border-b:after{content:var(--tw-content);border-bottom-width:1px}.after\:border-black\/10:after{content:var(--tw-content);border-color:#0000001a}.after\:border-stroke-300:after{content:var(--tw-content);border-color:var(--color-stroke-300)}.after\:border-transparent:after{content:var(--tw-content);border-color:transparent}.after\:bg-spot-peach-100:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(252 247 242 / var(--tw-bg-opacity))}.after\:bg-white:after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.after\:opacity-60:after{content:var(--tw-content);opacity:.6}.after\:opacity-70:after{content:var(--tw-content);opacity:.7}.after\:shadow-switch:after{content:var(--tw-content);--tw-shadow: 0px 0px 0px 1px rgba(0, 0, 0, .04), 0px 3px 8px 0px rgba(0, 0, 0, .15), 0px 3px 1px 0px rgba(0, 0, 0, .06);--tw-shadow-colored: 0px 0px 0px 1px var(--tw-shadow-color), 0px 3px 8px 0px var(--tw-shadow-color), 0px 3px 1px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.after\:transition-all:after{content:var(--tw-content);transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.focus-within\:border-stroke-250:focus-within{border-color:var(--color-stroke-250)}.focus-within\:shadow-xl:focus-within{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:scale-\[1\.025\]:hover{--tw-scale-x: 1.025;--tw-scale-y: 1.025;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-stroke-300:hover{border-color:var(--color-stroke-300)}.hover\:bg-background-100:hover{background-color:var(--color-background-100)}.hover\:bg-black:hover{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity))}.hover\:bg-black\/10:hover{background-color:#0000001a}.hover\:bg-black\/5:hover{background-color:#0000000d}.hover\:bg-spot-peach-300:hover{--tw-bg-opacity: 1;background-color:rgb(255 210 167 / var(--tw-bg-opacity))}.hover\:bg-spot-peach-350:hover{--tw-bg-opacity: 1;background-color:rgb(227 179 136 / var(--tw-bg-opacity))}.hover\:bg-white:hover{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.hover\:bg-white\/50:hover{background-color:#ffffff80}.hover\:bg-white\/70:hover{background-color:#ffffffb3}.hover\:bg-white\/8:hover{background-color:#ffffff14}.hover\:bg-white\/80:hover{background-color:#fffc}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:opacity-90:hover{opacity:.9}.hover\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\:shadow-xl:hover{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.after\:hover\:scale-110:hover:after{content:var(--tw-content);--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.focus-within\:hover\:border-stroke-350:hover:focus-within{border-color:var(--color-stroke-350)}.focus\:bg-black\/5:focus{background-color:#0000000d}.focus\:bg-spot-peach-300:focus{--tw-bg-opacity: 1;background-color:rgb(255 210 167 / var(--tw-bg-opacity))}.focus\:underline:focus{text-decoration-line:underline}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.placeholder\:focus\:text-start:focus::-moz-placeholder{text-align:start}.placeholder\:focus\:text-start:focus::placeholder{text-align:start}.focus\:before\:ring-stroke-800:focus:before{content:var(--tw-content);--tw-ring-color: var(--color-stroke-800)}.focus-visible\:z-\[1\]:focus-visible{z-index:1}.focus-visible\:outline:focus-visible{outline-style:solid}.focus-visible\:outline-stroke-900:focus-visible{outline-color:var(--color-stroke-900)}.focus-visible\:before\:ring-2:focus-visible:before{content:var(--tw-content);--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.active\:bg-black\/3:active{background-color:#00000008}.active\:bg-black\/5:active{background-color:#0000000d}.active\:bg-black\/8:active{background-color:#00000014}.active\:bg-spot-peach-250:active{--tw-bg-opacity: 1;background-color:rgb(254 224 195 / var(--tw-bg-opacity))}.active\:bg-stone-750:active{--tw-bg-opacity: 1;background-color:rgb(51 48 46 / var(--tw-bg-opacity))}.active\:bg-white\/30:active{background-color:#ffffff4d}.active\:bg-white\/35:active{background-color:#ffffff59}.active\:bg-white\/5:active{background-color:#ffffff0d}.active\:bg-white\/60:active{background-color:#fff9}.active\:fill-foreground-350:active{fill:var(--color-foreground-350)}.active\:fill-foreground-600:active{fill:var(--color-foreground-600)}.active\:fill-foreground-650:active{fill:var(--color-foreground-650)}.active\:text-foreground-350:active{color:var(--color-foreground-350)}.active\:text-foreground-450:active{color:var(--color-foreground-450)}.active\:text-foreground-600:active{color:var(--color-foreground-600)}.active\:text-foreground-static-350:active{color:var(--color-foreground-static-350)}.active\:text-system-red-550\/70:active{color:#993a45b3}.after\:active\:w-6:active:after{content:var(--tw-content);width:1.5rem}.after\:active\:translate-x-3:active:after{content:var(--tw-content);--tw-translate-x: .75rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\:block{display:block}@media (prefers-contrast: more){.contrast-more\:border{border-width:1px}.contrast-more\:border-2{border-width:2px}.contrast-more\:border-slate-400{--tw-border-opacity: 1;border-color:rgb(130 139 172 / var(--tw-border-opacity))}.contrast-more\:border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity))}.contrast-more\:fill-current{fill:currentColor}.contrast-more\:outline{outline-style:solid}.contrast-more\:outline-2{outline-width:2px}.contrast-more\:forced-color-adjust-none{forced-color-adjust:none}.before\:contrast-more\:border-2:before{content:var(--tw-content);border-width:2px}.contrast-more\:after\:pointer-events-none:after{content:var(--tw-content);pointer-events:none}.contrast-more\:after\:absolute:after{content:var(--tw-content);position:absolute}.contrast-more\:after\:h-2\/3:after{content:var(--tw-content);height:66.666667%}.contrast-more\:after\:w-2\/3:after{content:var(--tw-content);width:66.666667%}.contrast-more\:after\:border-2:after{content:var(--tw-content);border-width:2px}.contrast-more\:focus\:border-0:focus{border-width:0px}.contrast-more\:focus\:outline:focus{outline-style:solid}}.dark\:border:is([data-theme=dark] *){border-width:1px}.dark\:border-none:is([data-theme=dark] *){border-style:none}.dark\:border-black:is([data-theme=dark] *){--tw-border-opacity: 1;border-color:rgb(0 0 0 / var(--tw-border-opacity))}.dark\:border-black\/40:is([data-theme=dark] *){border-color:#0006}.dark\:border-slate-650:is([data-theme=dark] *){--tw-border-opacity: 1;border-color:rgb(49 58 82 / var(--tw-border-opacity))}.dark\:border-stroke-250:is([data-theme=dark] *){border-color:var(--color-stroke-250)}.dark\:border-white\/10:is([data-theme=dark] *){border-color:#ffffff1a}.dark\:border-white\/12:is([data-theme=dark] *){border-color:#ffffff1f}.dark\:border-white\/15:is([data-theme=dark] *){border-color:#ffffff26}.dark\:border-white\/5:is([data-theme=dark] *){border-color:#ffffff0d}.dark\:border-white\/8:is([data-theme=dark] *){border-color:#ffffff14}.dark\:bg-background-150:is([data-theme=dark] *){background-color:var(--color-background-150)}.dark\:bg-background-250:is([data-theme=dark] *){background-color:var(--color-background-250)}.dark\:bg-background-static-750:is([data-theme=dark] *){background-color:var(--color-background-static-750)}.dark\:bg-background-static-900:is([data-theme=dark] *){background-color:var(--color-background-static-900)}.dark\:bg-black:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity))}.dark\:bg-black\/20:is([data-theme=dark] *){background-color:#0003}.dark\:bg-black\/25:is([data-theme=dark] *){background-color:#00000040}.dark\:bg-black\/30:is([data-theme=dark] *){background-color:#0000004d}.dark\:bg-black\/35:is([data-theme=dark] *){background-color:#00000059}.dark\:bg-black\/40:is([data-theme=dark] *){background-color:#0006}.dark\:bg-black\/50:is([data-theme=dark] *){background-color:#00000080}.dark\:bg-midnight-700:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(36 47 80 / var(--tw-bg-opacity))}.dark\:bg-midnight-750:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(29 36 57 / var(--tw-bg-opacity))}.dark\:bg-midnight-800\/30:is([data-theme=dark] *){background-color:#171e324d}.dark\:bg-midnight-850:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(16 21 36 / var(--tw-bg-opacity))}.dark\:bg-midnight-850\/70:is([data-theme=dark] *){background-color:#101524b3}.dark\:bg-midnight-900:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(12 16 28 / var(--tw-bg-opacity))}.dark\:bg-midnight-900\/80:is([data-theme=dark] *){background-color:#0c101ccc}.dark\:bg-neutral-800:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(38 38 38 / var(--tw-bg-opacity))}.dark\:bg-saddle-250:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(242 221 204 / var(--tw-bg-opacity))}.dark\:bg-saddle-800:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(45 34 36 / var(--tw-bg-opacity))}.dark\:bg-slate-450\/30:is([data-theme=dark] *){background-color:#6b75974d}.dark\:bg-slate-600:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(69 81 114 / var(--tw-bg-opacity))}.dark\:bg-slate-700:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(40 47 66 / var(--tw-bg-opacity))}.dark\:bg-slate-750:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(31 35 48 / var(--tw-bg-opacity))}.dark\:bg-white\/20:is([data-theme=dark] *){background-color:#fff3}.dark\:bg-white\/3:is([data-theme=dark] *){background-color:#ffffff08}.dark\:bg-white\/30:is([data-theme=dark] *){background-color:#ffffff4d}.dark\:bg-white\/5:is([data-theme=dark] *){background-color:#ffffff0d}.dark\:bg-white\/8:is([data-theme=dark] *){background-color:#ffffff14}.dark\:bg-gradient-audio-input-dark:is([data-theme=dark] *){background-image:linear-gradient(180deg,#3e5189,#4b5c92)}.dark\:bg-gradient-audio-output-dark:is([data-theme=dark] *){background-image:linear-gradient(180deg,#3e5189 30%,#4b5c92 80%)}.dark\:bg-gradient-discover-dark:is([data-theme=dark] *){background-image:linear-gradient(180deg,#0c101c,#171e32,#242f50)}.dark\:bg-none:is([data-theme=dark] *){background-image:none}.dark\:fill-foreground-750:is([data-theme=dark] *){fill:var(--color-foreground-750)}.dark\:fill-white:is([data-theme=dark] *){fill:#fff}.dark\:text-foreground-700:is([data-theme=dark] *){color:var(--color-foreground-700)}.dark\:text-foreground-750:is([data-theme=dark] *){color:var(--color-foreground-750)}.dark\:text-link-350:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(77 141 250 / var(--tw-text-opacity))}.dark\:text-midnight-300:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(184 195 245 / var(--tw-text-opacity))}.dark\:text-midnight-400:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(127 141 196 / var(--tw-text-opacity))}.dark\:text-neutral-100:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(252 252 252 / var(--tw-text-opacity))}.dark\:text-saddle-100:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(255 253 251 / var(--tw-text-opacity))}.dark\:text-saddle-200:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(255 237 222 / var(--tw-text-opacity))}.dark\:text-saddle-250:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(242 221 204 / var(--tw-text-opacity))}.dark\:text-salmon-400:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(198 122 91 / var(--tw-text-opacity))}.dark\:text-slate-250\/60:is([data-theme=dark] *){color:#cfd8ec99}.dark\:text-slate-350:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(158 165 194 / var(--tw-text-opacity))}.dark\:text-slate-400:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(130 139 172 / var(--tw-text-opacity))}.dark\:text-system-red-350:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(250 129 139 / var(--tw-text-opacity))}.dark\:text-white:is([data-theme=dark] *){--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.dark\:text-white\/80:is([data-theme=dark] *){color:#fffc}.dark\:opacity-30:is([data-theme=dark] *){opacity:.3}.dark\:opacity-50:is([data-theme=dark] *){opacity:.5}.dark\:shadow-button-dark:is([data-theme=dark] *){--tw-shadow: 0px 1px 3px 0px rgba(0, 0, 0, .4), 0px .5px .5px 0px rgba(255, 255, 255, .12) inset;--tw-shadow-colored: 0px 1px 3px 0px var(--tw-shadow-color), inset 0px .5px .5px 0px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.dark\:shadow-none:is([data-theme=dark] *){--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.dark\:saturate-100:is([data-theme=dark] *){--tw-saturate: saturate(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.dark\:marker\:text-foreground-600 *:is([data-theme=dark] *)::marker{color:var(--color-foreground-600)}.dark\:marker\:text-foreground-600:is([data-theme=dark] *)::marker{color:var(--color-foreground-600)}.dark\:placeholder\:text-slate-350:is([data-theme=dark] *)::-moz-placeholder{--tw-text-opacity: 1;color:rgb(158 165 194 / var(--tw-text-opacity))}.dark\:placeholder\:text-slate-350:is([data-theme=dark] *)::placeholder{--tw-text-opacity: 1;color:rgb(158 165 194 / var(--tw-text-opacity))}.dark\:placeholder\:text-slate-400:is([data-theme=dark] *)::-moz-placeholder{--tw-text-opacity: 1;color:rgb(130 139 172 / var(--tw-text-opacity))}.dark\:placeholder\:text-slate-400:is([data-theme=dark] *)::placeholder{--tw-text-opacity: 1;color:rgb(130 139 172 / var(--tw-text-opacity))}.dark\:before\:bg-midnight-650:is([data-theme=dark] *):before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(44 58 99 / var(--tw-bg-opacity))}.dark\:before\:bg-midnight-800:is([data-theme=dark] *):before{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(23 30 50 / var(--tw-bg-opacity))}.dark\:before\:opacity-60:is([data-theme=dark] *):before{content:var(--tw-content);opacity:.6}.dark\:before\:opacity-70:is([data-theme=dark] *):before{content:var(--tw-content);opacity:.7}.dark\:after\:border-white\/20:is([data-theme=dark] *):after{content:var(--tw-content);border-color:#fff3}.dark\:after\:bg-slate-800:is([data-theme=dark] *):after{content:var(--tw-content);--tw-bg-opacity: 1;background-color:rgb(25 29 41 / var(--tw-bg-opacity))}.dark\:after\:opacity-50:is([data-theme=dark] *):after{content:var(--tw-content);opacity:.5}.dark\:after\:opacity-70:is([data-theme=dark] *):after{content:var(--tw-content);opacity:.7}.dark\:hover\:bg-background-450:hover:is([data-theme=dark] *){background-color:var(--color-background-450)}.dark\:hover\:bg-black\/30:hover:is([data-theme=dark] *){background-color:#0000004d}.dark\:hover\:bg-black\/40:hover:is([data-theme=dark] *){background-color:#0006}.dark\:hover\:bg-black\/50:hover:is([data-theme=dark] *){background-color:#00000080}.dark\:hover\:bg-black\/60:hover:is([data-theme=dark] *){background-color:#0009}.dark\:hover\:bg-slate-450\/40:hover:is([data-theme=dark] *){background-color:#6b759766}.dark\:hover\:bg-slate-550:hover:is([data-theme=dark] *){--tw-bg-opacity: 1;background-color:rgb(80 91 123 / var(--tw-bg-opacity))}.dark\:hover\:bg-white\/10:hover:is([data-theme=dark] *){background-color:#ffffff1a}.dark\:hover\:bg-white\/5:hover:is([data-theme=dark] *){background-color:#ffffff0d}.dark\:hover\:bg-white\/8:hover:is([data-theme=dark] *){background-color:#ffffff14}.hover\:dark\:bg-black\/50:is([data-theme=dark] *):hover{background-color:#00000080}.hover\:dark\:bg-midnight-600:is([data-theme=dark] *):hover{--tw-bg-opacity: 1;background-color:rgb(62 81 137 / var(--tw-bg-opacity))}.dark\:focus\:bg-white\/5:focus:is([data-theme=dark] *){background-color:#ffffff0d}.dark\:active\:bg-black\/20:active:is([data-theme=dark] *){background-color:#0003}.dark\:active\:bg-black\/25:active:is([data-theme=dark] *){background-color:#00000040}.dark\:active\:bg-slate-450\/20:active:is([data-theme=dark] *){background-color:#6b759733}.dark\:active\:bg-slate-600\/80:active:is([data-theme=dark] *){background-color:#455172cc}.dark\:active\:bg-white\/5:active:is([data-theme=dark] *){background-color:#ffffff0d}.dark\:active\:bg-white\/8:active:is([data-theme=dark] *){background-color:#ffffff14}.dark\:active\:fill-foreground-650:active:is([data-theme=dark] *){fill:var(--color-foreground-650)}.active\:dark\:text-system-red-350\/70:is([data-theme=dark] *):active{color:#fa818bb3}.dark\:active\:text-foreground-650:active:is([data-theme=dark] *){color:var(--color-foreground-650)}@media not all and (min-width: 640px){.max-sm\:mb-2{margin-bottom:.5rem}}@media (min-width: 640px){.sm\:relative{position:relative}.sm\:bottom-\[120px\]{bottom:120px}.sm\:col-span-1{grid-column:span 1 / span 1}.sm\:col-span-2{grid-column:span 2 / span 2}.sm\:col-start-2{grid-column-start:2}.sm\:row-start-auto{grid-row-start:auto}.sm\:mb-0{margin-bottom:0}.sm\:mb-16{margin-bottom:4rem}.sm\:mb-8{margin-bottom:2rem}.sm\:mt-0{margin-top:0}.sm\:line-clamp-1{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.sm\:line-clamp-2{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}.sm\:block{display:block}.sm\:inline-block{display:inline-block}.sm\:flex{display:flex}.sm\:grid{display:grid}.sm\:hidden{display:none}.sm\:h-\[424px\]{height:424px}.sm\:h-auto{height:auto}.sm\:min-h-\[120px\]{min-height:120px}.sm\:min-h-\[calc\(100dvh-120px-var\(--composer-container-height\)\)\]{min-height:calc(100dvh - 120px - var(--composer-container-height))}.sm\:w-96{width:24rem}.sm\:w-\[350px\]{width:350px}.sm\:w-\[700px\]{width:700px}.sm\:w-auto{width:auto}.sm\:w-settings{width:278px}.sm\:max-w-2xl{max-width:42rem}.sm\:max-w-none{max-width:none}.sm\:max-w-voiceSelector{max-width:18rem}.sm\:grow{flex-grow:1}.sm\:origin-top-right{transform-origin:top right}.sm\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.sm\:grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.sm\:grid-rows-\[1fr\,auto\,1fr\]{grid-template-rows:1fr auto 1fr}.sm\:flex-row{flex-direction:row}.sm\:items-end{align-items:flex-end}.sm\:items-center{align-items:center}.sm\:justify-center{justify-content:center}.sm\:justify-between{justify-content:space-between}.sm\:gap-2\.5{gap:.625rem}.sm\:gap-5{gap:1.25rem}.sm\:rounded-3xl{border-radius:1.25rem}.sm\:rounded-4xl{border-radius:1.5rem}.sm\:bg-white\/40{background-color:#fff6}.sm\:p-3{padding:.75rem}.sm\:px-0{padding-left:0;padding-right:0}.sm\:py-4{padding-top:1rem;padding-bottom:1rem}.sm\:pb-2{padding-bottom:.5rem}.sm\:pb-20{padding-bottom:5rem}.sm\:pb-3{padding-bottom:.75rem}.sm\:pb-40{padding-bottom:10rem}.sm\:pb-5{padding-bottom:1.25rem}.sm\:text-center{text-align:center}.sm\:text-md{font-size:1.25rem;line-height:1.625rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 460}.sm\:text-md bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:text-md strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:text-xl{font-size:1.75rem;line-height:2rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 480}.sm\:text-xl bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:text-xl strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:text-2xl{font-size:2.375rem;line-height:2.5rem;letter-spacing:-.02em;font-variation-settings:"opsz" 40,"wght" 480}.sm\:text-2xl bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:text-2xl strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.sm\:dark\:bg-black\/35:is([data-theme=dark] *){background-color:#00000059}}@media (min-width: 768px){.md\:mb-5{margin-bottom:1.25rem}.md\:hidden{display:none}.md\:w-fit{width:-moz-fit-content;width:fit-content}.md\:rounded-3xl{border-radius:1.25rem}.md\:rounded-6xl{border-radius:2rem}.md\:text-center{text-align:center}.md\:text-lg{font-size:1.5rem;line-height:1.9375rem;letter-spacing:-.01em;font-variation-settings:"opsz" 40,"wght" 440}.md\:text-lg bold{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}.md\:text-lg strong{font-weight:650;font-variation-settings:"opsz" 40,"wght" 650}}@media (min-width: 1024px){.lg\:flex-row{flex-direction:row}}.rtl\:left-auto:where([dir=rtl],[dir=rtl] *){left:auto}.rtl\:right-4:where([dir=rtl],[dir=rtl] *){right:1rem}@media (min-width: 640px){.sm\:rtl\:origin-top-left:where([dir=rtl],[dir=rtl] *){transform-origin:top left}}.\[\&\:not\(\:first-child\)\]\:pt-3\.5:not(:first-child){padding-top:.875rem}.\[\&\:not\(\:first-child\)\]\:pt-6:not(:first-child){padding-top:1.5rem}code{color:var(--color-foreground-static-150)}.hljs-comment,.hljs-meta{color:#aa9c87}.hljs-built_in,.hljs-class .hljs-title{color:#ffc42f}.hljs-doctag,.hljs-formula,.hljs-keyword,.hljs-literal{color:#67abf1}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#00b360}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#f96c00}.hljs-bullet,.hljs-link,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#e3b5fa}</style></head><body class="b_respl b_sydConvMode b_sydStandalone" dir="ltr"><script type="text/javascript" nonce="">//<![CDATA[
(function(n){var i,r,t;if(document.querySelector){i=[];r="ad";function u(){var w=sb_gt(),l=document.documentElement,h=document.body,u=0,n=-1,b=l.clientHeight,a=["#b_results ."+_G.adc,".sb_adsWv2",".ads","#b_topw ."+_G.adc],t,f,o,p,c,s,r;if(h){t=0;f=document.querySelector("#b_pole .b_PolePAContainer");f&&(t=f.offsetHeight,n=f?f.offsetTop:n);var v=document.querySelector("#b_results #productAdCarousel"),e=document.querySelector("#b_results .pa_b_supertop"),y=document.querySelector("#b_results .bn_wide");for(e?(n=e?e.offsetTop:n,t=e.offsetHeight):y?t+=y.offsetHeight:v&&(t+=v.offsetHeight),u=t,o=0;o<a.length;o++)for(p=a[o],c=document.querySelectorAll(p),s=0;s<c.length;s++)r=c[s],r&&r.className.indexOf("b_adTop")!==-1&&(u+=r.offsetHeight,n===-1&&(n=r?r.offsetTop:-1));u===0&&(u=-1);i=[n,u,l.clientWidth,b,h.offsetWidth,h.offsetHeight,sb_gt()-w]}}n?(t=n.onbeforefire,n.onbeforefire=function(){t&&t();u();n.mark(r,i)}):(t=si_PP,si_PP=function(){u();var n='"'+r+'":['+i.join()+"]";_G.C1=_G.C1?_G.C1+","+n:n;t.apply(null,[].slice.apply(arguments))})}})(_w.pp);_G.AppVer="50375106";
//]]></script><div id="app" style="--composer-container-height: 96px;"><div class="sr-only"><div aria-live="polite" aria-atomic="true"></div><div aria-live="assertive" aria-atomic="true"></div></div><div class="fixed inset-0"><div class="absolute size-full bg-gradient-chat-light dark:bg-midnight-850 dark:bg-none"></div></div><main class="relative overflow-hidden"><div data-testid="composer" class="pointer-events-none absolute bottom-0 flex w-full z-10"><dialog><input type="file" accept="image/png,image/jpg,image/svg+xml" class="hidden"></dialog><div class="t-bottom-fade absolute bottom-0 mx-4 box-content w-bottom-fade pt-bottom-fade h-bottom-fade" style="opacity: 1; will-change: auto;"><div class="fixed inset-0"><div class="absolute size-full bg-gradient-chat-light dark:bg-midnight-850 dark:bg-none"></div></div></div><div class="relative mb-4 flex w-full flex-col items-center px-3 sm:mb-8" style="opacity: 1; will-change: auto; transform: none;"><div class="relative max-h-full min-h-composer min-w-16 max-w-chat" style="transform: none; transform-origin: 50% 50% 0px;"><div class="absolute inset-0" style="border-radius: 28px; box-shadow: rgba(0, 0, 0, 0.18) 0px 10px 24px 0px; transform: none; transform-origin: 50% 50% 0px;"></div><div class="relative overflow-hidden backdrop-blur-2xl backdrop-saturate-200 before:bg-slate-200 before:opacity-40 dark:before:bg-midnight-800 dark:before:opacity-60 before:absolute before:inset-0 before:bg-blend-luminosity after:bg-spot-peach-100 after:opacity-60 dark:after:bg-slate-800 dark:after:opacity-50 after:absolute after:inset-0" style="border-radius: 28px; box-shadow: rgba(0, 0, 0, 0.06) 0px 42px 30px 0px; transform: none; transform-origin: 50% 50% 0px;"><div class="pointer-events-auto relative flex flex-col contrast-more:border-2 z-10" style="border-radius: 28px; box-shadow: rgba(255, 255, 255, 0.12) 0px 0px 0px 1px inset; transform: none; transform-origin: 50% 50% 0px;"><div class="relative flex max-h-full max-w-chat justify-center p-2 items-end" style="transform: none; transform-origin: 50% 50% 0px;"><div class="relative my-1 shrink-0 size-10" style="transform: none; transform-origin: 50% 50% 0px;"><button type="button" class="absolute size-10 rounded-xl fill-foreground-750 p-2 text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-black/30 dark:active:bg-black/20 end-0" aria-hidden="false" aria-label="Go to home" title="Go to home" data-testid="home-button" style="transform: none; transform-origin: 50% 50% 0px;"><div class="w-fit" style="opacity: 1; will-change: auto;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" fill="none" class="size-6" aria-hidden="true"><path fill="url(#a)" d="M85.855 18.313A11.574 11.574 0 0 0 74.75 10h-3.379a11.574 11.574 0 0 0-11.384 9.485L54.2 51.018l1.436-4.913a11.574 11.574 0 0 1 11.11-8.327H86.38l8.235 3.207 7.937-3.207h-2.316a11.574 11.574 0 0 1-11.105-8.313z"></path><path fill="url(#b)" d="M36.326 101.64A11.574 11.574 0 0 0 47.445 110h7.176c6.276 0 11.409-5.002 11.57-11.277l.781-30.405-1.634 5.583a11.574 11.574 0 0 1-11.108 8.321H34.432l-7.058-3.829-7.641 3.83h2.278c5.154 0 9.687 3.408 11.119 8.36z"></path><path fill="url(#c)" d="M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"></path><path fill="url(#d)" d="M74.248 10H34.15c-11.457 0-18.33 15.142-22.913 30.283-5.43 17.939-12.534 41.93 8.02 41.93H36.57c5.174 0 9.716-3.421 11.138-8.396 3.01-10.531 8.286-28.903 12.43-42.889 2.105-7.107 3.86-13.211 6.551-17.012C68.2 11.785 70.715 10 74.248 10"></path><path fill="url(#e)" d="M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"></path><path fill="url(#f)" d="M46.744 110h40.099c11.456 0 18.33-15.144 22.913-30.288 5.429-17.942 12.533-41.937-8.02-41.937H84.422a11.576 11.576 0 0 0-11.138 8.396c-3.01 10.533-8.286 28.909-12.43 42.897-2.106 7.109-3.86 13.214-6.552 17.016-1.51 2.131-4.025 3.916-7.558 3.916"></path><defs><radialgradient id="a" cx="0" cy="0" r="1" gradientTransform="matrix(-27.40125 -33.47302 31.47539 -25.76598 95.512 51.286)" gradientUnits="userSpaceOnUse"><stop offset="0.096" stop-color="#00AEFF"></stop><stop offset="0.773" stop-color="#2253CE"></stop><stop offset="1" stop-color="#0736C4"></stop></radialgradient><radialgradient id="b" cx="0" cy="0" r="1" gradientTransform="rotate(51.84 -70.254 70.14)scale(39.9779 38.7796)" gradientUnits="userSpaceOnUse"><stop stop-color="#FFB657"></stop><stop offset="0.634" stop-color="#FF5F3D"></stop><stop offset="0.923" stop-color="#C02B3C"></stop></radialgradient><radialgradient id="e" cx="0" cy="0" r="1" gradientTransform="matrix(-31.67773 90.58917 -108.5232 -37.949 103.796 30.703)" gradientUnits="userSpaceOnUse"><stop offset="0.066" stop-color="#8C48FF"></stop><stop offset="0.5" stop-color="#F2598A"></stop><stop offset="0.896" stop-color="#FFB152"></stop></radialgradient><lineargradient id="c" x1="31.75" x2="37.471" y1="18.75" y2="84.938" gradientUnits="userSpaceOnUse"><stop offset="0.156" stop-color="#0D91E1"></stop><stop offset="0.487" stop-color="#52B471"></stop><stop offset="0.652" stop-color="#98BD42"></stop><stop offset="0.937" stop-color="#FFC800"></stop></lineargradient><lineargradient id="d" x1="36.75" x2="39.874" y1="10" y2="82.213" gradientUnits="userSpaceOnUse"><stop stop-color="#3DCBFF"></stop><stop offset="0.247" stop-color="#0588F7" stop-opacity="0"></stop></lineargradient><lineargradient id="f" x1="106.964" x2="106.923" y1="33.365" y2="53.037" gradientUnits="userSpaceOnUse"><stop offset="0.058" stop-color="#F8ADFA"></stop><stop offset="0.708" stop-color="#A86EDD" stop-opacity="0"></stop></lineargradient></defs></svg></div></button></div><div class="relative my-1 shrink-0 size-10" style="transform: none; transform-origin: 50% 50% 0px;"><button type="button" class="absolute size-10 rounded-xl fill-foreground-750 p-2 text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-black/30 dark:active:bg-black/20" aria-hidden="false" aria-label="Upload image" title="Upload image" style="transform: none; transform-origin: 50% 50% 0px;"><div class="w-fit" style="opacity: 1; will-change: auto;"><svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="size-6" aria-hidden="true"><path d="M11.7498 3C12.1295 3 12.4434 3.28201 12.4931 3.64808L12.5 3.74985L12.5012 11H19.7543C20.1685 11 20.5043 11.3358 20.5043 11.75C20.5043 12.1297 20.2221 12.4435 19.8561 12.4932L19.7543 12.5H12.5012L12.5032 19.7491C12.5033 20.1633 12.1676 20.4993 11.7534 20.4993C11.3737 20.4993 11.0598 20.2173 11.0101 19.8512L11.0032 19.7494L11.0012 12.5H3.7522C3.33798 12.5 3.0022 12.1642 3.0022 11.75C3.0022 11.3703 3.28435 11.0565 3.65043 11.0068L3.7522 11H11.0012L11 3.75015C10.9999 3.33594 11.3356 3 11.7498 3Z"></path></svg></div></button></div><div class="relative flex grow flex-col overflow-hidden bg-white/90 shadow-composer-input before:absolute before:inset-0 before:rounded-3xl before:border-2 before:border-stroke-350 dark:bg-midnight-900/80 dark:shadow-none w-auto contrast-more:border-2 mx-2 before:opacity-0" aria-hidden="false" style="border-radius: 20px; transform: none; transform-origin: 50% 50% 0px;"><div class="w-full h-0" style="transform: none; transform-origin: 50% 50% 0px;"></div><div class="flex grow items-end w-auto grow" style="transform: none; transform-origin: 50% 50% 0px;"><div class="relative grow overflow-hidden" style="transform: none; transform-origin: 50% 50% 0px;"><div class="relative flex size-full cursor-text overflow-hidden text-black dark:text-white" style="transform: none; transform-origin: 50% 50% 0px;"><div class="flex grow flex-col gap-4 py-user-input" style="transform: none; transform-origin: 50% 50% 0px;"><div class="max-h-dvh-0.5 overflow-y-auto px-4"><div><label class="invisible block h-0 whitespace-nowrap" for="userInput">Message Copilot</label><textarea class="block min-h-user-input w-full resize-none overflow-y-hidden whitespace-pre-wrap bg-transparent text-black outline-none placeholder:text-stone-550/90 dark:text-white dark:placeholder:text-slate-400 text-base" placeholder="Message Copilot" id="userInput" role="textbox" spellcheck="false" enterkeyhint="enter" style="height: 26px !important;"></textarea></div></div></div></div></div><div class="relative bottom-0 my-1.5 flex h-9 items-center w-0"></div></div></div><div class="relative my-1 shrink-0 size-10" style="transform: none; transform-origin: 50% 50% 0px;"><button type="button" class="absolute size-10 rounded-xl fill-foreground-750 p-2 text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-black/30 dark:active:bg-black/20 start-0" aria-hidden="false" aria-label="Talk to Copilot" title="Talk to Copilot" data-testid="audio-call-button" style="transform: none; transform-origin: 50% 50% 0px;"><div class="w-fit" style="opacity: 1; will-change: auto;"><svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="size-6" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.7673 6.54284C16.7673 3.91128 14.634 1.77799 12.0024 1.77799C9.37089 1.77799 7.2376 3.91129 7.2376 6.54284L7.2376 13.5647C7.2376 16.1963 9.37089 18.3296 12.0024 18.3296C14.634 18.3296 16.7673 16.1963 16.7673 13.5647L16.7673 6.54284ZM12.0024 3.28268C13.803 3.28268 15.2626 4.7423 15.2626 6.54284L15.2626 13.5647C15.2626 15.3652 13.803 16.8249 12.0024 16.8249C10.2019 16.8249 8.74229 15.3652 8.74229 13.5647L8.74229 6.54284C8.74229 4.7423 10.2019 3.28268 12.0024 3.28268Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M20.0274 8.79987C19.6119 8.79987 19.2751 9.1367 19.2751 9.55221V13.5647C19.2751 17.5813 16.019 20.8374 12.0024 20.8374C7.98587 20.8374 4.72979 17.5813 4.72979 13.5647L4.72979 9.55221C4.72979 9.1367 4.39295 8.79987 3.97744 8.79987C3.56193 8.79987 3.2251 9.1367 3.2251 9.55221L3.2251 13.5647C3.2251 18.4123 7.15485 22.3421 12.0024 22.3421C16.85 22.3421 20.7798 18.4123 20.7798 13.5647V9.55221C20.7798 9.1367 20.443 8.79987 20.0274 8.79987Z" fill="currentColor"></path></svg></div></button></div></div></div></div></div></div></div><div class="absolute end-6 top-6 flex flex-col items-end z-30"><div style="opacity: 1; will-change: auto;"><button id=":r8:" aria-controls=":r7:" aria-expanded="false" aria-haspopup="menu" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 shadow-button-light dark:shadow-button-dark bg-white/70 hover:bg-white active:bg-white/60 dark:bg-slate-450/30 dark:hover:bg-slate-450/40 dark:active:bg-slate-450/20 text-sm size-10 rounded-full before:rounded-full before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Settings" data-testid="settings-button"><span class="absolute inset-0 rounded-full overflow-hidden backdrop-blur-2xl backdrop-saturate-200 before:bg-stone-200 before:opacity-30 dark:before:bg-midnight-650 dark:before:opacity-70 before:absolute before:inset-0 before:bg-blend-luminosity after:bg-white after:opacity-70 dark:after:bg-slate-800 dark:after:opacity-70 after:absolute after:inset-0"></span><div class="relative size-full rounded-full flex items-center justify-center uppercase text-md after:absolute after:-inset-px after:rounded-full after:border-[0.5px] after:border-black/10 dark:after:border-white/20"><div>B</div></div></button></div></div><div class="h-dvh" style="opacity: 1; transform: none;"><div class="flex size-full flex-col items-center overflow-y-auto overflow-x-hidden overscroll-contain text-foreground-800" data-testid="chat-page"><div></div><div class="mb-[var(--composer-container-height)] grow px-6 max-w-chat w-full" data-content="conversation" style="opacity: 1; will-change: auto;"><div class="relative pt-6 inline-block w-full space-y-8 min-h-[60px] sm:min-h-[120px]" style="opacity: 1;"><div class="absolute -z-10 w-full bottom-[60px] sm:bottom-[120px] h-[50px]"></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">You need to integrate python part with the xlwings.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Totally, lets wrap it up together. Heres a full integration, from compiling your C code to creating the Excel function using xlwings.</span></p><ol start="1" class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-5 marker:normal-nums marker:text-sm-strong"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Compile your C code into a shared library</strong> (like <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">regex-C-10072024.dll</code> on Windows).</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Wrap it in Python using CFFI</strong>.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Create an xlwings UDF</strong> that calls the Python function.</span></p></li></ol><p aria-live="polite" aria-atomic="true"><span class="">Here's the complete Python script:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex-C-10072024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the Python function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the xlwings UDF</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_pattern(input_list, </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">__name__ </span><span initial="start" animate="end" variants="[object Object]" custom="0">== </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"__main__"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Example usage</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"(?i)(neft)"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Neft"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Goneft"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Oil"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"NEFT Corporation"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_pattern(input_strings, </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">print</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Matches:"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches)
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Heres a quick breakdown of what this script does:</span></p><ul class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-4 px-1"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>CFFI</strong> part wraps the compiled C code into a Python function.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">match_pattern</code><strong> function</strong> executes the C function.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">match_pattern_udf</code><strong> function</strong> is the xlwings UDF that you can call from Excel.</span></p></li></ul><p aria-live="polite" aria-atomic="true"><span class="">Save this as a <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">.py</code> file and run it. When you open Excel and use <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">=match_pattern_udf(A1:A4, "(?i)(neft)")</code>, where cells <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">A1:A4</code> contain your input strings, itll call your C code via Python.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Happy coding and Excel-ing! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Why two separate UDFs?

from cffi import FFI
import xlwings as xw
import os

# Initialize CFFI
ffi = FFI()

# Define the function signatures
ffi.cdef("""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
""")

# Load the shared library
lib = ffi.dlopen("./regex-C-10072024.dll")

# Define the Python function
def match_pattern(input_list, pattern):
    input_array = ffi.new("char *[]", [ffi.new("char[]", s.encode('utf-8')) for s in input_list])
    output_array = ffi.new("char ***")
    num_matches = lib.match_pattern_in_array(input_array, len(input_list), pattern.encode('utf-8'), output_array)

    matches = [ffi.string(output_array[0][i]).decode('utf-8') for i in range(num_matches)]
    lib.free_matches(output_array[0], num_matches)
    return matches

# Define the xlwings UDF
@xw.func
def match_pattern_udf(input_strings, pattern):
    input_list = [x for x in input_strings if x is not None]  # Remove None values
    matches = match_pattern(input_list, pattern)
    return matches</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Ah, you're right. One well-crafted UDF should do the trick. Combining everything in one smooth flow:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex-C-10072024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the Python function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the xlwings UDF</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_pattern(input_list, </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Just one single UDF, <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">match_pattern_udf</code>, which you can call from Excel. Your C function is wrapped with CFFI, and the UDF is created with xlwings. That should cover it. Happy coding! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">You still have 2 different def.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Gotcha. We're aiming for seamless, one-function efficiency. Heres the full integration with just one unified function:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex-C-10072024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This way, <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">match_pattern_udf</code> does all the heavy lifting directly. Hope this helps! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">You need to include following os path:
os.environ['PATH'] = r'D:\dev\dll' + ';' + os.environ['PATH']+';'+r'D:\boost\stagelib\lib'+';'+r'D:\Programs\Msys2\ucrt64\bin'+';'+r'D:\Programs\Msys2\ucrt64\lib'</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Got it, lets merge all the pieces together in one go:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Include necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\dev\dll'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex-C-10072024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should work just fine. Your environment paths are set, and the Excel UDF is fully integrated with your C function. Ready to conquer your spreadsheet now? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Youve found me twice now! Any particular area you want to dive into, or should I just keep being my delightful AI self? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Yep, youre still talking to me! Think of me as your AI sidekick, always up for a chat, providing info, or just being around. What's next on your mind?</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Where is my history of chats?</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">For any data privacy concerns or questions about chat history, best to check out Microsofts privacy statement <a role="link" initial="start" animate="end" variants="[object Object]" custom="0" class="font-bold text-salmon-550 dark:text-midnight-400 hover:underline" target="_blank" rel="noreferrer" href="https://privacy.microsoft.com/en-us/privacystatement?form=MG0AV3" aria-label="https://privacy.microsoft.com/en-us/privacystatement">here</a>. It's got all the details you need.</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Previously I used to get list of all my historical sessions on right side. I do not find anything. Have you changed?</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Im not quite sure about the interface details or layout changes, but I can imagine its a bummer not having access to your past chats. Checking Microsoft's support pages or privacy policy might shed some light on this. Anything else on your mind?</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Yep, still me! You seem pretty fascinated by the name. Is there something specific you want to dive into or ask about? Lets keep the conversation rolling.</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Im starting to think were going in circles here. Whats really on your mind? Lets get to the heart of it.</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">I promise I'm still me! But I get it: you have "Bing AI" on the brain. Maybe there's something specific you need help with? Lets chat about it.</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">I have following code of CPP and compiling using Msys2 - g++ in a shared dll. I need you to convert that into C code (shared dll) and I have installed pcre2 package (ucrt) on msys so compitibility issue shall not be there:#define PCRE2_CODE_UNIT_WIDTH 8#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;vector&gt;#include &lt;pcre2.h&gt;extern "C" {int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array) {    // Define PCRE2 constants    #define PCRE2_CODE_UNIT_WIDTH 8    #define MAX_MATCHES 100    // Compile the regex pattern    pcre2_code *re;    PCRE2_SIZE erroffset;    int errornumber;    pcre2_match_data *match_data;    // Convert pattern to PCRE2 format    PCRE2_SPTR pattern_str = (PCRE2_SPTR)pattern;    PCRE2_UCHAR buffer[256];    re = pcre2_compile(        pattern_str,                /* the pattern */        PCRE2_ZERO_TERMINATED,      /* pattern is a zero-terminated string */        PCRE2_CASELESS,             /* case-insensitive matching */        &amp;errornumber,               /* for error number */        &amp;erroffset,                 /* for error offset */        NULL                        /* use default compile context */    );    if (!re) {        pcre2_get_error_message(errornumber, buffer, sizeof(buffer));        std::cerr &lt;&lt; "Error compiling regex: " &lt;&lt; buffer &lt;&lt; std::endl;        return -1;    }    // Prepare the match data    match_data = pcre2_match_data_create_from_pattern(re, NULL);    // Container for matched strings    std::vector&lt;std::string&gt; matches;    for (int i = 0; i &lt; array_length; ++i) {        PCRE2_SPTR subject = (PCRE2_SPTR)input_array[i];        int rc = pcre2_match(            re,                         /* the compiled pattern */            subject,                    /* the subject string */            strlen((char*)subject),     /* subject length */            0,                          /* start at offset 0 in subject */            0,                          /* default options */            match_data,                 /* match data */            NULL                        /* use default match context */        );        if (rc &gt;= 0) {            // Pattern matched, store the string            matches.push_back(input_array[i]);        }    }    // Free the PCRE2 resources    pcre2_code_free(re);    pcre2_match_data_free(match_data);    // Allocate memory for output array    *output_array = (const char **)malloc(matches.size() * sizeof(char *));    if (*output_array == NULL) {        return -1;    }    for (size_t i = 0; i &lt; matches.size(); ++i) {        (*output_array)[i] = strdup(matches[i].c_str());        if ((*output_array)[i] == NULL) {            return -1;        }    }    return matches.size();}void free_matches(const char **matches, int match_count) {    for (int i = 0; i &lt; match_count; ++i) {        free((void *)matches[i]);    }    free((void *)matches);}}Compilation g++ on Msys2 bash shell:  g++ -shared -o regex_cpp.dll regex_cpp.cpp -lpcre2-8</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Alright, lets convert that CPP code into C. Heres the equivalent C code:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PCRE2_CODE_UNIT_WIDTH 8</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pcre2.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_MATCHES 100</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">const</span> <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Define PCRE2 constants</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code </span><span initial="start" animate="end" variants="[object Object]" custom="0">*re;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SIZE </span><span initial="start" animate="end" variants="[object Object]" custom="0">erroffset;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">errornumber;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_data;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Convert pattern to PCRE2 format</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_UCHAR </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">256</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">re </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_compile(
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str,                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* the pattern */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_ZERO_TERMINATED,      </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* pattern is a zero-terminated string */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_CASELESS,             </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* case-insensitive matching */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;errornumber,               </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* for error number */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;erroffset,                 </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* for error offset */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">                        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* use default compile context */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!re) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_get_error_message(errornumber, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(buffer));
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Prepare the match data</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_create_from_pattern(re, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Allocate memory for matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**)</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(MAX_MATCHES </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)input_array[i];
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match(
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">re,                         </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* the compiled pattern */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject,                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* the subject string */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">strlen</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">*)subject),     </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* subject length */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,                          </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* start at offset 0 in subject */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,                          </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* default options */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data,                 </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* match data */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">                        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">/* use default match context */</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">&gt;= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;&amp; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">MAX_MATCHES) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Free the PCRE2 resources</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">To compile the C code using MSYS2 with the PCRE2 library installed:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">gcc </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_c.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_c.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">-lpcre2-8
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should get you up and running with a C version of your code. Just drop this into your workflow and it should work smoothly with your MSYS2 setup and PCRE2. Happy coding! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Next step is, give me xlwings python UDF to call this dll function from Excel.My compiled dll name is changed to regex_C_13102024.dll - I need to use cffi library in python.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Lets wrap this up in style by creating an xlwings UDF using CFFI to call your <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">regex_C_13102024.dll</code> from Excel. Heres how to do it:</span></p><ol start="1" class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-5 marker:normal-nums marker:text-sm-strong"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Load the shared library using CFFI.</strong></span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Wrap the C function in Python.</strong></span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Create an xlwings UDF.</strong></span></p></li></ol><p aria-live="polite" aria-atomic="true"><span class="">Heres the complete script:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\dev\dll'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">What does this script do?</span></p><ul class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-4 px-1"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>CFFI Setup:</strong> Initializes CFFI and sets up function signatures for calling your compiled C functions.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Shared Library Loading:</strong> Loads your compiled <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">regex_C_13102024.dll</code>.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Excel UDF:</strong> Defines a single xlwings UDF <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">match_pattern_udf</code> to use the C function directly in Excel.</span></p></li></ul><p aria-live="polite" aria-atomic="true"><span class="">With this setup, you can call <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">=match_pattern_udf(A1:A4, "(?i)(neft)")</code> directly from Excel where <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">A1:A4</code> are your input strings.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Ready to get it all working?  Lets make your Excel smarter!</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">But since cffi has changed recently, I need to define all paths with os library like this:os.environ['PATH'] = os.environ['PATH'] + ';' + r'D:\boost\stagelib\lib' + ';' + r'D:\Programs\Msys2\ucrt64\bin' + ';' + r'D:\Programs\Msys2\ucrt64\lib' + ';' + r'D:\Programs\Msys2\ucrt64\include' + ';' + r'D:\Programs\Msys2\home\j1304\Downloads'</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Totally noted. Lets make sure all paths are set properly before we proceed with the integration. Heres the updated script:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">With this setup, all necessary paths are configured correctly, the CFFI setup is complete, and the Excel UDF is ready to use. You should be able to call <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">=match_pattern_udf(A1:A4, "(?i)(neft)")</code> from Excel seamlessly. How does that look? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">You need to return matches as a vertical array in excel (list of lists)</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Gotcha, lets ensure the output matches Excels vertical array expectations. Heres the updated script to return matches as a list of lists:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches)]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># List of lists</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This adjustment ensures that the returned matches are a vertical array (list of lists) in Excel. Now, calling <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">=match_pattern_udf(A1:A4, "(?i)(neft)")</code> will give you a neat vertical list of matches. Ready to see it in action? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">C code is consistently giving differnt number of results in an array like this:Column1Scheme Code;Scheme Name;ISIN Div Payout/ISIN Growth;ISIN Div Reinvestment;Net Asset Value;Repurchase Price;Sale Price;DateOpen Ended Schemes ( Money Market )Taurus Mutual Fund139619;Taurus Investor Education Pool - Unclaimed Dividend - Growth;;;10.0000;;;01-Mar-2021139618;Taurus Investor Education Pool - Unclaimed Redemption - Growth;;;10.0000;;;01-Mar-2021139616;Taurus Unclaimed Dividend - Growth;;;13.8810;;;01-Mar-2021139617;Taurus Unclaimed Redemption - Growth;;;13.8824;;;01-Mar-2021Open Ended Schemes ( Equity Scheme - Multi Cap Fund )Baroda BNP Paribas Mutual Fund119354;Baroda BNP Paribas MULTI CAP FUND - Direct Plan - Growth Option;INF955L01AG0;;141.40;;;01-Mar-2021119353;Baroda BNP Paribas MULTI CAP FUND - Direct Plan - IDCW Option;INF955L01AE5;;37.45;;;01-Mar-2021102020;Baroda BNP Paribas MULTI CAP FUND - Regular Plan - Growth Option;INF955L01674;;131.62;;;01-Mar-2021102021;Baroda BNP Paribas MULTI CAP FUND - Regular Plan - IDCW Option;INF955L01658;INF955L01666;36.68;;;01-Mar-2021BNP Paribas Mutual Fund119988;BNP Paribas MULTI CAP Fund - Direct Plan - Growth Option;INF251K01HK3;;67.775;;;01-Mar-2021119987;BNP Paribas MULTI CAP Fund - Direct Plan - Income Distribution cum Capital Withdrawal Option;INF251K01HI7;INF251K01HJ5;19.309;;;01-Mar-2021113460;BNP PARIBAS MULTI CAP Fund-Growth Option;INF251K01951;;60.248;;;01-Mar-2021113461;BNP PARIBAS MULTI CAP Fund-Income Distribution cum Capital Withdrawal Option;INF251K01977;INF251K01969;16.363;;;01-Mar-2021ICICI Prudential Mutual Fund120599;ICICI Prudential Multicap Fund - Direct Plan -  Growth;INF109K014O9;;393.60;;;01-Mar-2021120598;ICICI Prudential Multicap Fund - Direct Plan -  IDCW;INF109K012O3;INF109K013O1;34.49;;;01-Mar-2021101228;ICICI Prudential Multicap Fund - Growth;INF109K01613;;366.17;;;01-Mar-2021101706;ICICI Prudential Multicap Fund - IDCW;INF109K01FK7;INF109K01621;23.11;;;01-Mar-2021Invesco Mutual Fund120413;Invesco India Multicap Fund - Direct Plan - Growth Option;INF205K01MS2;;70.71;;;01-Mar-2021120412;Invesco India Multicap Fund - Direct Plan - IDCW (Payout / Reinvestment);INF205K01MQ6;INF205K01MR4;64.01;;;01-Mar-2021107353;Invesco India Multicap Fund - Growth Option;INF205K01DN2;;62.92;;;01-Mar-2021107352;Invesco India Multicap Fund - IDCW (Payout / Reinvestment);INF205K01DO0;INF205K01DP7;57.05;;;01-Mar-2021ITI Mutual Fund147183;ITI Multi Cap Fund - Direct Plan - Growth Option;INF00XX01168;;13.4710;;;01-Mar-2021147186;ITI Multi Cap Fund - Direct Plan - IDCW Option;INF00XX01176;INF00XX01184;12.8882;;;01-Mar-2021147184;ITI Multi Cap Fund - Regular Plan - Growth Option;INF00XX01135;;12.9633;;;01-Mar-2021147185;ITI Multi Cap Fund - Regular Plan - IDCW Option;INF00XX01143;INF00XX01150;12.3828;;;01-Mar-2021L&amp;T Mutual Fund119291;L&amp;T Flexicap Fund-Direct Plan-Growth;INF917K01FC0;;106.023;;;01-Mar-2021119290;L&amp;T Flexicap Fund-Direct Plan-IDCW;INF917K01FB2;INF917K01FA4;36.138;;;01-Mar-2021118043;L&amp;T Flexicap Fund-Regular Plan-Growth;INF677K01031;;100.231;;;01-Mar-2021118044;L&amp;T Flexicap Fund-Regular Plan-IDCW;INF677K01049;INF677K01056;31.322;;;01-Mar-2021Mahindra Manulife Mutual Fund141223;Mahindra Manulife Multi Cap Fund - Direct Plan - IDCW;INF174V01366;INF174V01358;15.7498;;;01-Mar-2021141226;Mahindra Manulife Multi Cap Fund - Direct Plan -Growth;INF174V01341;;16.6314;;;01-Mar-2021141224;Mahindra Manulife Multi Cap Fund - Regular Plan - Growth;INF174V01317;;15.3958;;;01-Mar-2021141225;Mahindra Manulife Multi Cap Fund - Regular Plan - IDCW;INF174V01333;INF174V01325;14.5147;;;01-Mar-2021Nippon India Mutual Fund118652;NIPPON INDIA MULTI CAP FUND - DIRECT Plan - IDCW Option;INF204K01XD4;INF204K01XE2;43.2505;;;01-Mar-2021118651;Nippon India Multi Cap Fund - Direct Plan Growth Plan - Bonus Option;INF204K01D55;;122.0762;;;01-Mar-2021118650;Nippon India Multi Cap Fund - Direct Plan Growth Plan - Growth Option;INF204K01XF9;;122.0762;;;01-Mar-2021101163;NIPPON INDIA MULTI CAP FUND - IDCW Option;INF204K01455;INF204K01463;32.9615;;;01-Mar-2021101162;Nippon India Multi Cap Fund-Growth Plan-Bonus Option;INF204K01471;;114.9567;;;01-Mar-2021101161;Nippon India Multi Cap Fund-Growth Plan-Growth Option;INF204K01489;;114.9567;;;01-Mar-2021Principal Mutual Fund119451;Principal Multi Cap Growth Fund - Direct Plan -Half Yearly Income Distribution CUM Capital Withdrawal Option;INF173K01FN7;INF173K01FO5;54.62;;;01-Mar-2021100966;Principal Multi Cap Growth Fund- Half Yearly Income Distribution CUM Capital Withdrawal Option;INF173K01957;INF173K01965;42.41;;;01-Mar-2021119452;Principal Multi Cap Growth Fund-Direct Plan - Growth Option;INF173K01FQ0;;190.86;;;01-Mar-2021100967;Principal Multi Cap Growth Fund-Growth Option;INF173K01940;;179.52;;;01-Mar-2021quant Mutual Fund100631;quant Active Fund-GROWTH OPTION - Regular Plan;INF966L01234;;290.4192;;;01-Mar-2021120823;quant Active Fund-GROWTH OPTION-Direct Plan;INF966L01614;;298.3562;;;01-Mar-2021120822;quant Active Fund-IDCW Option - Direct Plan;INF966L01598;INF966L01606;34.539;;;01-Mar-2021100630;quant Active Fund-IDCW Option - Regular Plan;INF966L01218;INF966L01226;33.2385;;;01-Mar-2021Sundaram Mutual Fund147587;Sundaram Equity Fund Direct Plan - Growth;INF903JA1IK5;;13.6973;;;01-Mar-2021147588;Sundaram Equity Fund Direct Plan - Payout of Income Distribution cum Capital Withdrawal (IDCW);INF903JA1IL3;;13.6838;;;01-Mar-2021147589;Sundaram Equity Fund Direct Plan - Reinvestment of Income Distribution cum Capital Withdrawal (IDCW);INF903JA1IM1;;13.6838;;;01-Mar-2021147584;Sundaram Equity Fund Regular Plan - Growth;INF903JA1IH1;;13.3004;;;01-Mar-2021147586;Sundaram Equity Fund Regular Plan - Payout of Income Distribution cum Capital Withdrawal (IDCW);INF903JA1II9;;13.3008;;;01-Mar-2021147585;Sundaram Equity Fund Regular Plan - Reinvestment of Income Distribution cum Capital Withdrawal (IDCW);INF903JA1IJ7;;13.3008;;;01-Mar-2021Open Ended Schemes ( Equity Scheme - Large Cap Fund )Aditya Birla Sun Life Mutual Fund119528;Aditya Birla Sun Life Frontline Equity Fund - Growth - Direct Plan;INF209K01YY7;;303.8;;;01-Mar-2021119527;Aditya Birla Sun Life Frontline Equity Fund-DIRECT - IDCW;INF209K01YX9;INF209K01YW1;67.78;;;01-Mar-2021103174;Aditya Birla Sun Life Frontline Equity Fund-Growth;INF209K01BR9;;283.09;;;01-Mar-2021103173;Aditya Birla Sun Life Frontline Equity Fund-Regular - IDCW;INF209K01BO6;INF209K01EC5;29.23;;;01-Mar-2021Axis Mutual Fund120465;Axis Bluechip Fund - Direct Plan - Growth;INF846K01DP8;;42.63;;;01-Mar-2021120466;Axis Bluechip Fund - Direct Plan - IDCW;INF846K01DN3;INF846K01DO1;20.90;;;01-Mar-2021112277;Axis Bluechip Fund - Regular Plan - Growth;INF846K01164;;38.73;;;01-Mar-2021112278;Axis Bluechip Fund - Regular Plan - IDCW;INF846K01172;INF846K01180;18.59;;;01-Mar-2021Bandhan Mutual Fund108799;BANDHAN Large Cap Fund - Regular Plan - Growth;INF194K01516;;41.59;;;01-Mar-2021108800;BANDHAN Large Cap Fund - Regular Plan - IDCW;INF194K01490;INF194K01508;16.55;;;01-Mar-2021118479;BANDHAN Large Cap Fund-Direct Plan-Growth;INF194K01Z44;;45.30;;;01-Mar-2021118478;BANDHAN Large Cap Fund-Direct Plan-IDCW;INF194K01Z51;INF194K01Z69;20.59;;;01-Mar-2021Baroda BNP Paribas Mutual Fund112943;Baroda Large cap Fund - Plan A - Growth Option;INF955L01633;;18.83;;;01-Mar-2021112944;Baroda Large cap Fund - Plan A - IDCW Option;INF955L01617;INF955L01625;14.98;;;01-Mar-2021119367;Baroda Large cap Fund - Plan B (Direct) - Growth Option;INF955L01AJ4;;19.95;;;01-Mar-2021119366;Baroda Large cap Fund - Plan B (Direct) - IDCW Option;INF955L01AH8;;16.01;;;01-Mar-2021BNP Paribas Mutual Fund119893;BNP Paribas LARGE CAP Fund - Direct Plan - Growth Option;INF251K01HN7;;130.28;;;01-Mar-2021119894;BNP Paribas LARGE CAP Fund - Direct Plan - Income Distribution cum Capital Withdrawal Option;INF251K01HL1;INF251K01HM9;21.32;;;01-Mar-2021113544;BNP PARIBAS LARGE CAP Fund-Growth Option;INF251K01894;;119.03;;;01-Mar-2021113545;BNP PARIBAS LARGE CAP Fund-Income Distribution cum Capital Withdrawal Option;INF251K01910;INF251K01902;18.85;;;01-Mar-2021Pattern: (?i)(^\d{6}((?=.*direct)|(?=.*growth)|(?=.*gold)|(?=.*silver))((?!(equity|cap|hybrid|Solution Oriented|FOF|elss|regular|idcw|dividend|div|hybrid|balanced advantage|index|nifty)).)*$)My original cpp code was stable and gave me 1886 matches. Why C code is consistent even though it is on the same line as cpp code with virtually nothing has changed.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">There could be several reasons why your C code isn't producing the same stable results as your C++ code. Here are a few things to check:</span></p><ol start="1" class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-5 marker:normal-nums marker:text-sm-strong"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Memory Management</strong>: C has more manual memory management than C++. Ensure you're handling memory allocation and deallocation correctly.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Library Versions</strong>: Make sure the PCRE2 library version in your C environment matches the one used with your C++ code. Different versions might have subtle differences in behavior.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Compiler Differences</strong>: Check if different compiler settings or optimization levels are affecting the results. Flags used during compilation can affect the behavior of the compiled code.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Thread Safety</strong>: If your code is running in a multi-threaded environment, ensure there are no data races or concurrency issues.</span></p></li></ol><p aria-live="polite" aria-atomic="true"><span class="">Here's a refined version of your C code for clarity:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PCRE2_CODE_UNIT_WIDTH 8</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pcre2.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_MATCHES 100</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">const</span> <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code </span><span initial="start" animate="end" variants="[object Object]" custom="0">*re;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SIZE </span><span initial="start" animate="end" variants="[object Object]" custom="0">erroffset;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">errornumber;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_data;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_UCHAR </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">256</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">re </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_compile(
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_ZERO_TERMINATED,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_CASELESS,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;errornumber,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;erroffset,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!re) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_get_error_message(errornumber, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(buffer));
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_create_from_pattern(re, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**)</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(MAX_MATCHES </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)input_array[i];
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match(
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">re,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">strlen</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">*)subject),
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">&gt;= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;&amp; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">MAX_MATCHES) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++j) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">And make sure to compile it using the same flags and settings as your C++ code:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">gcc </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">-lpcre2-8
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Try running this refined code and see if it stabilizes your results. If you still face issues, we might need to debug further by checking specific compiler flags or environmental differences. Hang in there! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">What did you change? My C code is only giving 100 results instead of 1886 results consistently?</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">I added the <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">MAX_MATCHES</code> definition to ensure the matches array doesn't exceed 100 results, but it seems like that might be too limiting for your use case. Let's remove that restriction to make sure you get all 1886 matches.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Heres the revised code without the 100-result limitation:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">define</span> PCRE2_CODE_UNIT_WIDTH 8</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pcre2.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">const</span> <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code </span><span initial="start" animate="end" variants="[object Object]" custom="0">*re;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SIZE </span><span initial="start" animate="end" variants="[object Object]" custom="0">erroffset;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">errornumber;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_data;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_UCHAR </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">256</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">re </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_compile(
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern_str,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_ZERO_TERMINATED,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_CASELESS,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;errornumber,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;erroffset,
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!re) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_get_error_message(errornumber, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(buffer));
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">buffer);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_create_from_pattern(re, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">PCRE2_SPTR </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(PCRE2_SPTR)input_array[i];
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match(
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">re,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">subject,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">strlen</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">*)subject),
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_data,
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">);

        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(rc </span><span initial="start" animate="end" variants="[object Object]" custom="0">&gt;= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">realloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++j) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++j) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_code_free(re);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">pcre2_match_data_free(match_data);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">++i) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">((</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Try this updated code. It should handle more than 100 matches now, just like your original CPP code. Hows that looking now?</span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Now this python console error (xlwings):Traceback (most recent call last):  File "D:\Programs\Python\Lib\site-packages\win32com\server\policy.py", line 298, in _Invoke_    return self._invoke_(dispid, lcid, wFlags, args)           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "D:\Programs\Python\Lib\site-packages\win32com\server\policy.py", line 303, in _invoke_    return S_OK, -1, self._invokeex_(dispid, lcid, wFlags, args, None, None)                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "D:\Programs\Python\Lib\site-packages\win32com\server\policy.py", line 633, in _invokeex_    return func(*args)           ^^^^^^^^^^^  File "D:\Programs\Python\Lib\site-packages\xlwings\com_server.py", line 235, in CallUDF    res = call_udf(script, fname, args, this_workbook, FromVariant(caller))          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  File "D:\Programs\Python\Lib\site-packages\xlwings\udfs.py", line 536, in call_udf    ret = func(*args)          ^^^^^^^^^^^  File "d:\dev\udf3-dll.py", line 27, in match_pattern_udf    matches = [[ffi.string(output_array[0][i]).decode('utf-8')] for i in range(num_matches)]  # List of lists                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 88: invalid continuation byte</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">It looks like theres a decoding issue. Lets handle that so it works smoothly. Well adjust the Python code to handle possible encoding issues and ensure it can fall back on a default safe encoding if needed. Heres how you can do it:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches):
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">UnicodeDecodeError:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'latin-1'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Fallback encoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches.append([</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">])

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This way, it tries to decode using UTF-8 first, and if that fails, it falls back to Latin-1. That should handle your decoding issue and give you a robust result in Excel. Ready to give it a try? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">I have this another C code which uses glib in msys2:#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;glib.h&gt;#define MAX_MATCHES 100// Function to match pattern in an array of stringsint match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array) {    GError *error = NULL;    GRegex *regex = g_regex_new(pattern, 0, 0, &amp;error);        if (error) {        fprintf(stderr, "Error compiling regex: %s\n", error-&gt;message);        g_error_free(error);        return -1;    }    char **matches = malloc(MAX_MATCHES * sizeof(char *));    if (!matches) {        g_regex_unref(regex);        return -1;    }    int match_count = 0;    for (int i = 0; i &lt; array_length &amp;&amp; match_count &lt; MAX_MATCHES; i++) {        if (g_regex_match(regex, input_array[i], 0, NULL)) {            matches[match_count] = strdup(input_array[i]);            if (!matches[match_count]) {                g_regex_unref(regex);                for (int j = 0; j &lt; match_count; j++) {                    free(matches[j]);                }                free(matches);                return -1;            }            match_count++;        }    }    g_regex_unref(regex);    *output_array = matches;    return match_count;}// Function to free the array of matched stringsvoid free_matches(char **matches, int match_count) {    for (int i = 0; i &lt; match_count; i++) {        free(matches[i]);    }    free(matches);}Let's compile this one into dll and check. Give me changed xlwings python UDF also. Does this code define max match limit of array to only 100. If so remove that limit.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Lets refine the C code to remove the 100-match limit and then create the corresponding xlwings Python UDF using the CFFI library.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Heres the updated C code without the match limit:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">realloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Function to free the array of matched strings</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile this code into a DLL using MSYS2:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">gcc </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0)
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Heres the xlwings Python UDF using CFFI to call this new DLL:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_glib_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches):
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">UnicodeDecodeError:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'latin-1'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Fallback encoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches.append([</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">])

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should handle the entire integration, providing a function you can call from Excel that matches patterns in arrays using the GLib regex engine. Ready to test it out? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">instead of gcc can I try clang because I have that toolchain as well in Msys2. Can you give me compitible clang C code and compilation?</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Sure thing! Here's how to compile the C code using the Clang toolchain in MSYS2:</span></p><p aria-live="polite" aria-atomic="true"><span class=""><strong>C Code</strong> (unchanged since Clang is compatible with the same C code weve already prepared):</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">realloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class=""><strong>Compilation Command using Clang in MSYS2:</strong></span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0)
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should work seamlessly with your Clang toolchain.</span></p><p aria-live="polite" aria-atomic="true"><span class="">And heres the <strong>xlwings Python UDF</strong> to use this DLL:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_glib_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches):
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">UnicodeDecodeError:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'latin-1'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Fallback encoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches.append([</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">])

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should get your setup working with Clang and provide a robust Excel UDF. Give it a spin and lets see those matches in action! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Results are still inconcictent unlike tmy first cpp code which I gave you to modify into C. For your information I am giving you sample data from Excel.My A column which has data is like this:Column1Scheme Code;Scheme Name;ISIN Div Payout/ISIN Growth;ISIN Div Reinvestment;Net Asset Value;Repurchase Price;Sale Price;DateOpen Ended Schemes ( Money Market )Taurus Mutual Fund139619;Taurus Investor Education Pool - Unclaimed Dividend - Growth;;;10.0000;;;01-Mar-2021139618;Taurus Investor Education Pool - Unclaimed Redemption - Growth;;;10.0000;;;01-Mar-2021139616;Taurus Unclaimed Dividend - Growth;;;13.8810;;;01-Mar-2021139617;Taurus Unclaimed Redemption - Growth;;;13.8824;;;01-Mar-2021Open Ended Schemes ( Equity Scheme - Multi Cap Fund )Baroda BNP Paribas Mutual Fund119354;Baroda BNP Paribas MULTI CAP FUND - Direct Plan - Growth Option;INF955L01AG0;;141.40;;;01-Mar-2021119353;Baroda BNP Paribas MULTI CAP FUND - Direct Plan - IDCW Option;INF955L01AE5;;37.45;;;01-Mar-2021102020;Baroda BNP Paribas MULTI CAP FUND - Regular Plan - Growth Option;INF955L01674;;131.62;;;01-Mar-2021102021;Baroda BNP Paribas MULTI CAP FUND - Regular Plan - IDCW Option;INF955L01658;INF955L01666;36.68;;;01-Mar-2021BNP Paribas Mutual Fund119988;BNP Paribas MULTI CAP Fund - Direct Plan - Growth Option;INF251K01HK3;;67.775;;;01-Mar-2021119987;BNP Paribas MULTI CAP Fund - Direct Plan - Income Distribution cum Capital Withdrawal Option;INF251K01HI7;INF251K01HJ5;19.309;;;01-Mar-2021113460;BNP PARIBAS MULTI CAP Fund-Growth Option;INF251K01951;;60.248;;;01-Mar-2021113461;BNP PARIBAS MULTI CAP Fund-Income Distribution cum Capital Withdrawal Option;INF251K01977;INF251K01969;16.363;;;01-Mar-2021ICICI Prudential Mutual Fund120599;ICICI Prudential Multicap Fund - Direct Plan -  Growth;INF109K014O9;;393.60;;;01-Mar-2021120598;ICICI Prudential Multicap Fund - Direct Plan -  IDCW;INF109K012O3;INF109K013O1;34.49;;;01-Mar-2021101228;ICICI Prudential Multicap Fund - Growth;INF109K01613;;366.17;;;01-Mar-2021101706;ICICI Prudential Multicap Fund - IDCW;INF109K01FK7;INF109K01621;23.11;;;01-Mar-2021There are 12022 elements. Could it be the reson that in C, enough memory locations or pointers or addresses have not been defined to handle such a big data and CPP can handle that data? If that is not so, could the reson be that threads are behaving unexpectedly, but in latest code, if you see, No multi threading has been used. So that cannot be the reason.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">For such a large dataset, memory allocation issues could indeed be a culprit. Also, differences in memory management between C and C++ might be affecting stability. Let's address both potential issues:</span></p><ol start="1" class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-5 marker:normal-nums marker:text-sm-strong"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Memory Allocation</strong>: Ensure we are properly allocating and reallocating memory.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class=""><strong>Consistent Execution</strong>: Double-check every step of memory handling for large datasets.</span></p></li></ol><p aria-live="polite" aria-atomic="true"><span class="">Here's the adjusted C code with more robust memory handling:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**temp_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">realloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!temp_matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">temp_matches;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile using Clang:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0)
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">The corresponding Python code:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"./regex_C_glib_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches):
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">UnicodeDecodeError:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'latin-1'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Fallback encoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches.append([</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">])

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">With this setup, memory management should be more stable and efficient for larger datasets. Try this approach and see if it stabilizes the results. </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">I am giving you my python UDF which uses that cpp dll file I gave you in the beginning. I feel that python is not able to properly ensure memory co-ordination or perhaps there is a speed differnce in which results are flushed to python and it's speed of receiving the same and storing:import osimport xlwings as xwimport cffiffi = cffi.FFI()ffi.cdef("""    int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);    void free_matches(const char **matches, int match_count);""")# Load the DLLos.environ['PATH'] = r'D:\Programs\Msys2\home\j1304\Downloads' + ';' + os.environ['PATH']+';'+r'D:\Programs\Msys2\ucrt64\lib'+';'+r'D:\Programs\Msys2\ucrt64\bin'dll = ffi.dlopen("regex_cpp.dll")@xw.funcdef match_pattern_pcre2(input_list, pattern):    try:        # Convert input strings into a C array        input_array = [ffi.new("char[]", (item or "").encode('utf-8')) for item in input_list]        input_array_c = ffi.new("char*[]", input_array)                # Prepare output array (pointer to pointer)        output_array_c = ffi.new("const char***")  # triple pointer                # Call the DLL function        match_count = dll.match_pattern_in_array(input_array_c, len(input_list), pattern.encode('utf-8'), output_array_c)                # If the match count is negative, return an empty list        if match_count &lt; 0:            return [[""] for _ in input_list]  # Return an empty list vertically                # Convert output back to Python        output_list = [ffi.string(output_array_c[0][i]).decode('utf-8') for i in range(match_count)]                # Create a result list that matches the original input length        final_output = [[item] if item in output_list else [""] for item in input_list]  # Vertical output (column)                # Free the output array allocated by the DLL        dll.free_matches(output_array_c[0], match_count)                return final_output    except Exception as e:        print(f"Error: {e}")        return [[""] for _ in input_list]  # Return vertical empty list on error</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Looks like we need to ensure memory coordination and efficient handling. Here's an adjusted version to handle potential memory issues and optimize processing:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi

</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi.FFI()
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"regex_cpp.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_pcre2</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert input strings into a C array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">or</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">).encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char*[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Prepare output array (pointer to pointer)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Call the DLL function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.match_pattern_in_array(input_array_c, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># If the match count is negative, return an empty list</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]] </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return an empty list vertically</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert output back to Python</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count)]
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Create a result list that matches the original input length</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[item] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">else</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Vertical output (column)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Free the output array allocated by the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.free_matches(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">Exception </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">e:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">print</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">f"Error: <span class="hljs-subst">{e}</span>"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]] </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return vertical empty list on error</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">In this version:</span></p><ol start="1" class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-5 marker:normal-nums marker:text-sm-strong"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">The <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: opacity;">match_pattern_pcre2</code> function ensures efficient memory handling for large datasets.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">Improved error handling for consistency and stability.</span></p></li></ol><p aria-live="polite" aria-atomic="true"><span class="">Give this a shot to see if it handles large datasets more reliably! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">You did not undrstand my point. I gave you Python UDF which successfully gave consistent results when using CPP. I want you to look at your following python UDF which is not consistent:import osfrom cffi import FFIimport xlwings as xw# Set necessary pathsos.environ['PATH'] = os.environ['PATH'] + ';' + r'D:\boost\stagelib\lib' + ';' + r'D:\Programs\Msys2\ucrt64\bin' + ';' + r'D:\Programs\Msys2\ucrt64\lib' + ';' + r'D:\Programs\Msys2\ucrt64\include' + ';' + r'D:\Programs\Msys2\home\j1304\Downloads'# Initialize CFFIffi = FFI()# Define the function signaturesffi.cdef("""int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);void free_matches(char **matches, int match_count);""")# Load the shared librarylib = ffi.dlopen("regex-C-xlwings-clang.dll")@xw.funcdef match_pattern_udf(input_strings, pattern):    input_list = [x for x in input_strings if x is not None]  # Remove None values    input_array = ffi.new("char *[]", [ffi.new("char[]", s.encode('utf-8')) for s in input_list])    output_array = ffi.new("char ***")    num_matches = lib.match_pattern_in_array(input_array, len(input_list), pattern.encode('utf-8'), output_array)    matches = []    for i in range(num_matches):        try:            match = ffi.string(output_array[0][i]).decode('utf-8')        except UnicodeDecodeError:            match = ffi.string(output_array[0][i]).decode('latin-1')  # Fallback encoding        matches.append([match])    lib.free_matches(output_array[0], num_matches)    return matches</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Got it. Let's focus on making the C version as reliable as the C++ version. Here's a more careful look at the Python UDF to ensure consistency and proper memory handling:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">from</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Set necessary paths</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\boost\stagelib\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\include'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Initialize CFFI</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">FFI()

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Define the function signatures</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the shared library</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">lib </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"regex-C-xlwings-clang.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_udf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_strings, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_strings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">x </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">is</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">not</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">None</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Remove None values</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char *[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">s.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">s </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list])
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char ***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.match_pattern_in_array(input_array, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array)

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Ensure memory consistency and reliable decoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[]
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(num_matches):
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">UnicodeDecodeError:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.string(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'latin-1'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Fallback encoding</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches.append([</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">match</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">])

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">lib.free_matches(output_array[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_matches)
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Here are some key points to ensure consistency:</span></p><ul class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-4 px-1"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">Memory allocation and reallocation are handled correctly.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">Any issues with string encoding are caught and handled gracefully.</span></p></li></ul><p aria-live="polite" aria-atomic="true"><span class="">Give this a shot and see if the results stabilize. If the problem persists, it might be worth comparing the internals of the C and C++ versions more closely, especially focusing on any subtle differences in memory handling. Let's aim for consistent success! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Another thing I wish to point out is that if match is not found then my cpp python UDF produces blank cells in  between but your C Python UDf is not doing so. I am again producing my successful Python UDF that consistently produces 1886 results from 12022 elements using cpp dll. You need to look at it and ensure that my new python UDF which is based on that is aligned to that:import osimport xlwings as xwimport cffiffi = cffi.FFI()ffi.cdef("""    int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);    void free_matches(const char **matches, int match_count);""")# Load the DLLos.environ['PATH'] = r'D:\Programs\Msys2\home\j1304\Downloads' + ';' + os.environ['PATH']+';'+r'D:\Programs\Msys2\ucrt64\lib'+';'+r'D:\Programs\Msys2\ucrt64\bin'dll = ffi.dlopen("regex_cpp.dll")@xw.funcdef match_pattern_pcre2(input_list, pattern):    try:        # Convert input strings into a C array        input_array = [ffi.new("char[]", (item or "").encode('utf-8')) for item in input_list]        input_array_c = ffi.new("char*[]", input_array)                # Prepare output array (pointer to pointer)        output_array_c = ffi.new("const char***")  # triple pointer                # Call the DLL function        match_count = dll.match_pattern_in_array(input_array_c, len(input_list), pattern.encode('utf-8'), output_array_c)                # If the match count is negative, return an empty list        if match_count &lt; 0:            return [[""] for _ in input_list]  # Return an empty list vertically                # Convert output back to Python        output_list = [ffi.string(output_array_c[0][i]).decode('utf-8') for i in range(match_count)]                # Create a result list that matches the original input length        final_output = [[item] if item in output_list else [""] for item in input_list]  # Vertical output (column)                # Free the output array allocated by the DLL        dll.free_matches(output_array_c[0], match_count)                return final_output    except Exception as e:        print(f"Error: {e}")        return [[""] for _ in input_list]  # Return vertical empty list on error</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Thanks for the detailed information and context! Let's make sure the new Python UDF using the C DLL aligns with your successful C++ implementation.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Heres the updated Python UDF, taking into account the handling of blank cells when there is no match:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi

</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi.FFI()
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array);
void free_matches(const char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"regex-C-xlwings-clang.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_pcre2</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert input strings into a C array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">or</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">).encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char*[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Prepare output array (pointer to pointer)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Call the DLL function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.match_pattern_in_array(input_array_c, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># If the match count is negative, return an empty list</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">_ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return an empty list vertically</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert output back to Python</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count)]
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Create a result list that matches the original input length</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[item] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">else</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Vertical output (column)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Free the output array allocated by the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.free_matches(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">Exception </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">e:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">print</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">f"Error: <span class="hljs-subst">{e}</span>"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">_ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return vertical empty list on error</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This Python UDF mirrors your successful C++ UDF closely:</span></p><ul class="relative list-outside marker:text-foreground-750 dark:marker:text-foreground-600 flex flex-col ms-4 px-1"><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">It ensures blank cells are returned if no match is found.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">It maintains consistent memory handling and structure.</span></p></li><li class="ps-2" style="opacity: 1; will-change: auto;"><p aria-live="polite" aria-atomic="true"><span class="">It processes the results vertically to match Excels output format.</span></p></li></ul><p aria-live="polite" aria-atomic="true"><span class="">Give this a shot and let me know if it aligns better with your C++ results! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">But still there are no blank elements in between in excel array. I am again giving you my original CPP code which may give you clue why C code is not producing blank cells in array:#define PCRE2_CODE_UNIT_WIDTH 8#include &lt;iostream&gt;#include &lt;cstring&gt;#include &lt;vector&gt;#include &lt;pcre2.h&gt;extern "C" {int match_pattern_in_array(const char **input_array, int array_length, const char *pattern, const char ***output_array) {    // Define PCRE2 constants    #define PCRE2_CODE_UNIT_WIDTH 8    #define MAX_MATCHES 100    // Compile the regex pattern    pcre2_code *re;    PCRE2_SIZE erroffset;    int errornumber;    pcre2_match_data *match_data;    // Convert pattern to PCRE2 format    PCRE2_SPTR pattern_str = (PCRE2_SPTR)pattern;    PCRE2_UCHAR buffer[256];    re = pcre2_compile(        pattern_str,                /* the pattern */        PCRE2_ZERO_TERMINATED,      /* pattern is a zero-terminated string */        PCRE2_CASELESS,             /* case-insensitive matching */        &amp;errornumber,               /* for error number */        &amp;erroffset,                 /* for error offset */        NULL                        /* use default compile context */    );    if (!re) {        pcre2_get_error_message(errornumber, buffer, sizeof(buffer));        std::cerr &lt;&lt; "Error compiling regex: " &lt;&lt; buffer &lt;&lt; std::endl;        return -1;    }    // Prepare the match data    match_data = pcre2_match_data_create_from_pattern(re, NULL);    // Container for matched strings    std::vector&lt;std::string&gt; matches;    for (int i = 0; i &lt; array_length; ++i) {        PCRE2_SPTR subject = (PCRE2_SPTR)input_array[i];        int rc = pcre2_match(            re,                         /* the compiled pattern */            subject,                    /* the subject string */            strlen((char*)subject),     /* subject length */            0,                          /* start at offset 0 in subject */            0,                          /* default options */            match_data,                 /* match data */            NULL                        /* use default match context */        );        if (rc &gt;= 0) {            // Pattern matched, store the string            matches.push_back(input_array[i]);        }    }    // Free the PCRE2 resources    pcre2_code_free(re);    pcre2_match_data_free(match_data);    // Allocate memory for output array    *output_array = (const char **)malloc(matches.size() * sizeof(char *));    if (*output_array == NULL) {        return -1;    }    for (size_t i = 0; i &lt; matches.size(); ++i) {        (*output_array)[i] = strdup(matches[i].c_str());        if ((*output_array)[i] == NULL) {            return -1;        }    }    return matches.size();}void free_matches(const char **matches, int match_count) {    for (int i = 0; i &lt; match_count; ++i) {        free((void *)matches[i]);    }    free((void *)matches);}}</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Thanks for sharing your C++ code again. Your C++ implementation correctly maintains the input order and places blank cells for non-matches. Let's make sure the C code does the same.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Here's the updated C code that mimics the C++ approach:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(input_array[i]);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">} </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">else</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches[match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">); </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Maintain blank cells for non-matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(!matches[match_count]) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">j++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
                </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[j]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">-1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count++;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile using Clang:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0)
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">And heres the updated Python UDF to match the behavior of your C++ implementation:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi

</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi.FFI()
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"regex_C_glib_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_pcre2</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert input strings into a C array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">or</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">).encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char*[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Prepare output array (pointer to pointer)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Call the DLL function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.match_pattern_in_array(input_array_c, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># If the match count is negative, return an empty list</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">_ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return an empty list vertically</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert output back to Python</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count)]
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Create a result list that matches the original input length</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[item] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0">!= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">else</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Vertical output (column)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Free the output array allocated by the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.free_matches(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">Exception </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">e:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">print</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">f"Error: <span class="hljs-subst">{e}</span>"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">_ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return vertical empty list on error</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This approach should ensure consistency and include blank cells for non-matches, just like your C++ implementation. Give this a go! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Okay that was a success. Finally I could produce 1886 results and consistently that many with this wrapper function of Excel:=FILTER(match_pattern_udf(A1:A12022,CONCAT(N1)),match_pattern_udf(A1:A12022,CONCAT(N1))&lt;&gt;"")Now since we have stablished let's mimic my cpp code's multi-threading in C code and also in python UDF accordingly (if change is required in Python UDF)</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">That's great news!  Now, lets introduce multi-threading in the C code and ensure the Python UDF can handle it smoothly. Well use the Pthread library for multi-threading in C.</span></p><h3 class="text-md-strong pb-1 [&amp;:not(:first-child)]:pt-3.5">Updated C Code with Multi-Threading</h3><p aria-live="polite" aria-atomic="true"><span class="">Heres the C code with multi-threading:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pthread.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">typedef</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-class"><span class="hljs-keyword">struct</span> {</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**input_array;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">start_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">end_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">***matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_count;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*mutex;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">} </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData;

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">thread_function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">void</span> *arg)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)arg;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(data-&gt;pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;start_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;end_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_lock(data-&gt;mutex);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;matches[*data-&gt;match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(data-&gt;input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">(*data-&gt;match_count)++;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_unlock(data-&gt;mutex);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">4</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Number of threads</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">threads[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">PTHREAD_MUTEX_INITIALIZER;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].pattern </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].start_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">== </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">- </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;matches;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;match_count;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;mutex;

        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_create(&amp;threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_function, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;thread_data[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_join(threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile using Clang:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0) </span><span initial="start" animate="end" variants="[object Object]" custom="0">-lpthread
</span></code></pre></div></div></div><h3 class="text-md-strong pb-1 [&amp;:not(:first-child)]:pt-3.5">Updated Python UDF</h3><p aria-live="polite" aria-atomic="true"><span class="">Since the multi-threading is handled in the C code, the Python UDF remains mostly the same:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">python</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">os
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xlwings </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">xw
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">import</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi

</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">cffi.FFI()
</span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.cdef(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"""
int match_pattern_in_array(char **input_array, int array_length, const char *pattern, char ***output_array);
void free_matches(char **matches, int match_count);
"""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Load the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\home\j1304\Downloads'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0">os.environ[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'PATH'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\lib'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">';'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">r'D:\Programs\Msys2\ucrt64\bin'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0">dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.dlopen(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"regex_C_glib_multithread_13102024.dll"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">@xw.func</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">def</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_pcre2</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">input_list, pattern</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">):
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">try</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert input strings into a C array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">(item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">or</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">).encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_list]
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"char*[]"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Prepare output array (pointer to pointer)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">ffi.new(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"const char***"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Call the DLL function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.match_pattern_in_array(input_array_c, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list), </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern.encode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">), </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_array_c)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># If the match count is negative, return an empty list</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">:
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]] </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return an empty list vertically</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Convert output back to Python</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[ffi.string(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][i]).decode(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">'utf-8'</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">range</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(match_count)]
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Create a result list that matches the original input length</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[item] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0">!= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">else</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">] </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">item </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">in</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">output_list]  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Vertical output (column)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Free the output array allocated by the DLL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">dll.free_matches(output_array_c[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">], </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count)
        
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">final_output
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">except</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">Exception </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">as</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">e:
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">print</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">f"Error: <span class="hljs-subst">{e}</span>"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">[[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">""</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">]] </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">len</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(input_list)  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment"># Return vertical empty list on error</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This setup should leverage multi-threading in C to enhance performance while maintaining consistency and correctness in your Excel output. Ready to see the boosted performance in action? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">See the warnign in my compilation:$ clang -shared -o regex-C-xlwings-clang.dll regex-C-xlwings.c $(pkg-config --cflags --libs glib-2.0)regex-C-xlwings.c:32:47: warning: incompatible pointer types assigning to 'char **' from 'char *'      [-Wincompatible-pointer-types]   32 |             data-&gt;matches[*data-&gt;match_count] = strdup(data-&gt;input_array[i]);      |                                               ^ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~1 warning generated.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Ah, I see. The warning points to an issue with assigning a <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">char *</code> to a <code class="mx-0.5 rounded-[4px] border border-stroke-300 bg-spot-peach-200/50 px-1 py-px font-mono text-foreground-800 text-sm dark:bg-midnight-900" style="opacity: 1; will-change: auto;">char **</code>. Lets fix that by ensuring that the correct pointer types are used.</span></p><p aria-live="polite" aria-atomic="true"><span class="">Heres the corrected C code:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pthread.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">typedef</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-class"><span class="hljs-keyword">struct</span> {</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**input_array;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">start_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">end_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">***matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_count;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*mutex;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">} </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData;

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">thread_function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">void</span> *arg)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)arg;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(data-&gt;pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;start_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;end_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_lock(data-&gt;mutex);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(data-&gt;input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;matches[*data-&gt;match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">match;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">(*data-&gt;match_count)++;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_unlock(data-&gt;mutex);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">4</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Number of threads</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">threads[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">PTHREAD_MUTEX_INITIALIZER;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].pattern </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].start_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">== </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">- </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;matches;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;match_count;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;mutex;

        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_create(&amp;threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_function, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;thread_data[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_join(threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile using Clang:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0) </span><span initial="start" animate="end" variants="[object Object]" custom="0">-lpthread
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should fix the pointer type warning and ensure your multi-threading works as intended. Lets see those threads work their magic! </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Again a warning:$ clang -shared -o regex-C-xlwings-clang.dll regex-C-xlwings.c $(pkg-config --cflags --libs glib-2.0)regex-C-xlwings.c:33:47: warning: incompatible pointer types assigning to 'char **' from 'char *';      take the address with &amp; [-Wincompatible-pointer-types]   33 |             data-&gt;matches[*data-&gt;match_count] = match;      |                                               ^ ~~~~~      |                                                 &amp;1 warning generated.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">It looks like we just need to ensure were assigning pointers correctly. Heres the updated version:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">c</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glib.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pthread.h&gt;</span></span></span><span initial="start" animate="end" variants="[object Object]" custom="0">

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">typedef</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-class"><span class="hljs-keyword">struct</span> {</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**input_array;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">const</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*pattern;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">start_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">end_index;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">***matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match_count;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*mutex;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">} </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData;

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">thread_function</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">void</span> *arg)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*data </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">*)arg;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GError </span><span initial="start" animate="end" variants="[object Object]" custom="0">*error </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">GRegex </span><span initial="start" animate="end" variants="[object Object]" custom="0">*regex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_new(data-&gt;pattern, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;error);

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(error) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">fprintf</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">stderr</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-string">"Error compiling regex: %s\n"</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">error-&gt;message);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_error_free(error);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;start_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;end_index; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(g_regex_match(regex, </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;input_array[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">)) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_lock(data-&gt;mutex);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*match </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">strdup(data-&gt;input_array[i]);
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">data-&gt;matches[</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">][*data-&gt;match_count] </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">match;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">(*data-&gt;match_count)++;
            </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_mutex_unlock(data-&gt;mutex);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">g_regex_unref(regex);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">match_pattern_in_array</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **input_array, <span class="hljs-type">int</span> array_length, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *pattern, <span class="hljs-type">char</span> ***output_array)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">4</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;  </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-comment">// Number of threads</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">threads[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">ThreadData </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[num_threads];
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">pthread_mutex_t</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">PTHREAD_MUTEX_INITIALIZER;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">**matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">malloc</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">sizeof</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">char</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">*));
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">;

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].input_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">input_array;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].pattern </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">pattern;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].start_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">+ </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">* </span><span initial="start" animate="end" variants="[object Object]" custom="0">(array_length </span><span initial="start" animate="end" variants="[object Object]" custom="0">/ </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads);
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">if</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(i </span><span initial="start" animate="end" variants="[object Object]" custom="0">== </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads </span><span initial="start" animate="end" variants="[object Object]" custom="0">- </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">1</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">) </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].end_index </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">array_length;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].matches </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;matches;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].match_count </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;match_count;
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_data[i].mutex </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;mutex;

        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_create(&amp;threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">, </span><span initial="start" animate="end" variants="[object Object]" custom="0">thread_function, </span><span initial="start" animate="end" variants="[object Object]" custom="0">&amp;thread_data[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">num_threads; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0">pthread_join(threads[i], </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-literal">NULL</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}

    </span><span initial="start" animate="end" variants="[object Object]" custom="0">*output_array </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0">matches;
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">return</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count;
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}

</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">void</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-title function_">free_matches</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-params">(<span class="hljs-type">char</span> **matches, <span class="hljs-type">int</span> match_count)</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-keyword">for</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">(</span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-type">int</span></span><span initial="start" animate="end" variants="[object Object]" custom="0"> </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">= </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-number">0</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i </span><span initial="start" animate="end" variants="[object Object]" custom="0">&lt; </span><span initial="start" animate="end" variants="[object Object]" custom="0">match_count; </span><span initial="start" animate="end" variants="[object Object]" custom="0">i++) </span><span initial="start" animate="end" variants="[object Object]" custom="0">{
        </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches[i]);
    </span><span initial="start" animate="end" variants="[object Object]" custom="0">}
    </span><span initial="start" animate="end" variants="[object Object]" custom="0"><span class="hljs-built_in">free</span></span><span initial="start" animate="end" variants="[object Object]" custom="0">(matches);
</span><span initial="start" animate="end" variants="[object Object]" custom="0">}
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">Compile using Clang:</span></p><div class="rounded-xl dark:border dark:border-stroke-250" style="opacity: 1; will-change: auto;"><div class="flex w-full items-center justify-between rounded-t-xl border-b border-white/20 bg-background-static-850 py-2 pe-2.5 ps-4 text-foreground-static-250 text-sm dark:border-stroke-250 dark:bg-background-static-900"><span class="capitalize">sh</span><button class="relative min-h-9 min-w-9 gap-1.5 rounded-xl bg-transparent p-2 text-foreground-static-250 text-sm before:absolute before:inset-0 before:rounded-xl before:border before:border-transparent hover:bg-white/8 active:bg-white/5 active:fill-foreground-650 active:text-foreground-static-350 before:contrast-more:border-2" type="button" title="Copy code"><div class="flex items-center justify-center gap-2" aria-hidden="true"><svg viewBox="0 0 14 13" xmlns="http://www.w3.org/2000/svg" class="w-3.5"><g id="Group 130"><path id="Vector" d="M11.3727 4.91772L6.50783 4.93405C5.91077 4.93606 5.42838 5.4217 5.43039 6.01876L5.44672 10.8836C5.44872 11.4807 5.93436 11.963 6.53142 11.961L11.3963 11.9447C11.9933 11.9427 12.4757 11.4571 12.4737 10.86L12.4574 5.99517C12.4554 5.39811 11.9697 4.91572 11.3727 4.91772Z" fill="currentColor"></path><path id="Vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M6.51001 5.47462C6.21148 5.47562 5.97028 5.71844 5.97128 6.01697L5.98762 10.8818C5.98862 11.1803 6.23144 11.4215 6.52997 11.4205L11.3948 11.4042C11.6933 11.4032 11.9345 11.1604 11.9335 10.8618L11.9172 5.99701C11.9162 5.69848 11.6734 5.45728 11.3748 5.45829L6.51001 5.47462ZM4.89021 6.0206C4.8872 5.12501 5.61079 4.39655 6.50638 4.39354L11.3712 4.37721C12.2668 4.3742 12.9953 5.09779 12.9983 5.99338L13.0146 10.8582C13.0176 11.7538 12.294 12.4823 11.3984 12.4853L6.5336 12.5016C5.63801 12.5046 4.90955 11.781 4.90654 10.8854L4.89021 6.0206Z" fill="currentColor"></path><path id="Vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M2.71357 1.81169C2.59888 1.81207 2.48904 1.858 2.40822 1.93937C2.32739 2.02074 2.2822 2.13088 2.28259 2.24557L2.29892 7.11041C2.29931 7.22509 2.34523 7.33493 2.4266 7.41575C2.50797 7.49658 2.61811 7.54177 2.7328 7.54138L3.27334 7.53957C3.63158 7.53837 3.92296 7.8278 3.92416 8.18604C3.92536 8.54427 3.63593 8.83566 3.27769 8.83686L2.73716 8.83867C2.27841 8.84021 1.83783 8.65945 1.51236 8.33616C1.18689 8.01286 1.00317 7.57351 1.00163 7.11476L0.985299 2.24992C0.983759 1.79117 1.16452 1.3506 1.48782 1.02513C1.81111 0.699651 2.25046 0.515936 2.70921 0.514396L7.57405 0.498064C8.0328 0.496524 8.47337 0.677285 8.79885 1.00058C9.12432 1.32388 9.30804 1.76323 9.30958 2.22198L9.31139 2.76251C9.31259 3.12075 9.02316 3.41213 8.66492 3.41334C8.30669 3.41454 8.0153 3.12511 8.0141 2.76687L8.01229 2.22633C8.0119 2.11165 7.96597 2.00181 7.8846 1.92098C7.80323 1.84016 7.69309 1.79497 7.5784 1.79535L2.71357 1.81169Z" fill="currentColor"></path></g></svg> Copy</div></button></div><div class="rounded-b-xl bg-background-static-850 px-4 pb-1.5 dark:bg-background-static-900"><div class="code-block-scrollbar overflow-x-auto whitespace-pre pb-3 pt-4 font-mono text-sm"><pre><code class="text-sm"><span initial="start" animate="end" variants="[object Object]" custom="0">clang </span><span initial="start" animate="end" variants="[object Object]" custom="0">-shared </span><span initial="start" animate="end" variants="[object Object]" custom="0">-o </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread_13102024.dll </span><span initial="start" animate="end" variants="[object Object]" custom="0">regex_C_glib_multithread.c </span><span initial="start" animate="end" variants="[object Object]" custom="0">$(pkg-config </span><span initial="start" animate="end" variants="[object Object]" custom="0">--cflags </span><span initial="start" animate="end" variants="[object Object]" custom="0">--libs </span><span initial="start" animate="end" variants="[object Object]" custom="0">glib-2.0) </span><span initial="start" animate="end" variants="[object Object]" custom="0">-lpthread
</span></code></pre></div></div></div><p aria-live="polite" aria-atomic="true"><span class="">This should properly assign the pointer and get rid of the warning. Hows that looking? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">Bing AI</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">Hey again! Looks like we've done quite the tech dance here. Anything specific on your mind, or shall we dive back into some coding magic? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div></div><div class="min-h-[calc(100dvh-60px-var(--composer-container-height))] sm:min-h-[calc(100dvh-120px-var(--composer-container-height))]"><div class="pb-6 inline-block w-full space-y-8" style="opacity: 1; will-change: auto; transform: none;"><div class="space-y-3"><h2 class="sr-only" aria-label="You">You</h2><div class="flex w-full flex-col items-end" data-content="user-message"><div class="h-fit max-w-[80%] self-end whitespace-pre-wrap break-words rounded-2xl bg-spot-peach-300/50 px-5 py-3 dark:bg-midnight-750 text-base">I want today's history of session with you.</div></div></div><div class="space-y-3 " data-content="ai-message"><h2 class="sr-only" aria-label="Copilot">Copilot</h2><div class="space-y-3 break-words"><p aria-live="polite" aria-atomic="true"><span class="">For data privacy concerns or queries about chat history, it's best to check Microsoft's privacy statement <a role="link" initial="start" animate="end" variants="[object Object]" custom="0" class="font-bold text-salmon-550 dark:text-midnight-400 hover:underline" target="_blank" rel="noreferrer" href="https://privacy.microsoft.com/en-us/privacystatement?form=MG0AV3" aria-label="https://privacy.microsoft.com/en-us/privacystatement">here</a>. It'll have all the details you need. Anything else I can help you with today? </span></p><div class="flex gap-2 transition-opacity duration-300 ease-in-out opacity-0"><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs up message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 2.29418C10.3913 1.31688 11.6841 0.866611 12.4829 1.70374C12.6455 1.87416 12.8081 2.05832 12.9176 2.22254C13.2379 2.70305 13.3725 3.33584 13.4218 3.9522C13.4721 4.58034 13.438 5.25446 13.3738 5.86473C13.3093 6.47735 13.2129 7.03948 13.1328 7.44766C13.1294 7.46535 13.1259 7.48277 13.1225 7.49989H14.006C15.8777 7.49989 17.2924 9.19503 16.9576 11.0365L16.2737 14.7983C15.8017 17.3942 13.2078 19.0289 10.6622 18.3347L5.06251 16.8075C4.14894 16.5583 3.45455 15.8144 3.26885 14.8859L2.91581 13.1207C2.63809 11.7321 3.69991 10.5623 4.82905 10.116C5.15163 9.9885 5.44337 9.82668 5.66974 9.62586C7.37583 8.11234 7.99442 6.90276 9.05406 4.77684C9.4084 4.06594 9.77205 3.10043 10.052 2.29418ZM12.0165 7.87851L12.0169 7.87696L12.0187 7.86962L12.0262 7.83852C12.0328 7.81068 12.0426 7.76892 12.0549 7.71482C12.0793 7.60658 12.1135 7.44919 12.1515 7.25525C12.2277 6.86655 12.3188 6.33493 12.3793 5.76005C12.4401 5.18282 12.4685 4.57569 12.425 4.03195C12.3806 3.47644 12.2652 3.04673 12.0855 2.77724C12.0264 2.68859 11.9138 2.55593 11.7594 2.3941C11.5605 2.18565 11.1314 2.23417 10.9967 2.62217C10.7141 3.43598 10.3334 4.45183 9.94904 5.22294C8.88216 7.36338 8.19326 8.72396 6.33336 10.3739C5.99304 10.6758 5.58878 10.891 5.19665 11.046C4.31631 11.394 3.75035 12.1944 3.89639 12.9246L4.24943 14.6898C4.36085 15.2469 4.77748 15.6932 5.32562 15.8427L10.9254 17.3699C12.9052 17.9099 14.9227 16.6384 15.2898 14.6194L15.9738 10.8577C16.197 9.62998 15.2538 8.49989 14.006 8.49989H12.5015C12.3476 8.49989 12.2022 8.42895 12.1074 8.3076C12.0127 8.18627 11.9792 8.02785 12.0165 7.87851C12.0165 7.87847 12.0165 7.87855 12.0165 7.87851Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Thumbs down message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M10.052 17.7057C10.3913 18.683 11.6841 19.1333 12.4829 18.2962C12.6455 18.1257 12.8081 17.9416 12.9176 17.7774C13.2379 17.2968 13.3725 16.6641 13.4218 16.0477C13.4721 15.4195 13.438 14.7454 13.3738 14.1352C13.3093 13.5225 13.2129 12.9604 13.1328 12.5522C13.1294 12.5345 13.1259 12.5171 13.1225 12.5H14.006C15.8777 12.5 17.2924 10.8049 16.9576 8.96334L16.2737 5.20164C15.8017 2.60569 13.2078 0.970952 10.6622 1.66519L5.06251 3.19239C4.14894 3.44154 3.45455 4.18547 3.26885 5.11401L2.91581 6.87918C2.63809 8.2678 3.69991 9.43756 4.82905 9.88388C5.15163 10.0114 5.44337 10.1732 5.66974 10.374C7.37583 11.8875 7.99442 13.0971 9.05406 15.2231C9.4084 15.9339 9.77205 16.8995 10.052 17.7057ZM12.0165 12.1214L12.0169 12.1229L12.0187 12.1303L12.0262 12.1614C12.0328 12.1892 12.0426 12.231 12.0549 12.2851C12.0793 12.3933 12.1135 12.5507 12.1515 12.7446C12.2277 13.1333 12.3188 13.665 12.3793 14.2398C12.4401 14.8171 12.4685 15.4242 12.425 15.9679C12.3806 16.5235 12.2652 16.9532 12.0855 17.2227C12.0264 17.3113 11.9138 17.444 11.7594 17.6058C11.5605 17.8142 11.1314 17.7657 10.9967 17.3777C10.7141 16.5639 10.3334 15.5481 9.94904 14.777C8.88216 12.6365 8.19326 11.2759 6.33336 9.62597C5.99304 9.32406 5.58878 9.1089 5.19665 8.9539C4.31631 8.60592 3.75035 7.80549 3.89639 7.0753L4.24943 5.31013C4.36085 4.753 4.77748 4.30665 5.32562 4.15715L10.9254 2.62995C12.9052 2.08999 14.9227 3.36145 15.2898 5.38053L15.9738 9.14223C16.197 10.3699 15.2538 11.5 14.006 11.5H12.5015C12.3476 11.5 12.2022 11.5709 12.1074 11.6923C12.0127 11.8136 11.9792 11.972 12.0165 12.1214C12.0165 12.1214 12.0165 12.1213 12.0165 12.1214Z" fill="currentColor"></path></svg></button><button aria-pressed="false" type="button" class="relative flex items-center justify-center text-foreground-800 fill-foreground-800 active:text-foreground-600 active:fill-foreground-600 dark:active:text-foreground-650 dark:active:fill-foreground-650 bg-transparent hover:bg-black/5 active:bg-black/3 dark:hover:bg-white/8 dark:active:bg-white/5 text-xs size-9 rounded-xl before:rounded-xl before:absolute before:inset-0 before:pointer-events-none before:border before:border-transparent before:contrast-more:border-2 outline-2 outline-offset-1 focus-visible:z-[1] focus-visible:outline focus-visible:outline-stroke-900" title="Report message"><svg viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-5"><path d="M5 13H16.5C16.8993 13 17.1375 12.5549 16.916 12.2226L14.1009 8L16.916 3.77735C17.1375 3.44507 16.8993 3 16.5 3H4.5C4.22386 3 4 3.22386 4 3.5V17.5C4 17.7761 4.22386 18 4.5 18C4.77614 18 5 17.7761 5 17.5V13ZM5 12V4H15.5657L13.084 7.72265C12.972 7.8906 12.972 8.1094 13.084 8.27735L15.5657 12H5Z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div><div id="inAppFeedbackOcv"></div></main></div><script type="text/javascript" nonce="">//<![CDATA[
_G.FCT=new Date;
//]]></script><script type="text/javascript" nonce="">//<![CDATA[
_G.BCT=new Date;
//]]></script><script type="text/javascript" nonce="">//<![CDATA[
0;(function(n,t){onload=function(){_G.BPT=new Date;n&&n();!_w.sb_ppCPL&&t&&sb_st(function(){t(new Date)},0)}})(_w.onload,_w.si_PP);sj_be(_d.body, 'load', function(){if(_w.lb)lb();}, false);;
//]]></script><script type="module" crossorigin="anonymous" nonce="" src="./Co-pilot-chat-13102024_files/bundle.js.download"></script><script type="text/javascript" nonce="">//<![CDATA[
_w.rms.js({'A:rms:answers:Shared:BingCore.Bundle':'\/rp\/v-9MDlZf3UpTm3z78CHvLGE8SMU.gz.js'});;
//]]></script><script type="text/javascript" nonce="">//<![CDATA[
_G.HT=new Date;
//]]></script><div id="video-roll-root-mask"></div><textarea tabindex="-1" aria-hidden="true" style="min-height: 0px !important; max-height: none !important; height: 0px !important; visibility: hidden !important; overflow: hidden !important; position: absolute !important; z-index: -1000 !important; top: 0px !important; right: 0px !important; border-width: 0px; box-sizing: border-box; font-family: Ginto, ui-sans-serif, system-ui, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Noto Color Emoji&quot;; font-size: 17px; font-style: normal; font-weight: 400; letter-spacing: normal; line-height: 26px; padding: 0px; tab-size: 4; text-indent: 0px; text-rendering: auto; text-transform: none; width: 170px; word-break: normal;"></textarea><script type="text/javascript" async="" src="./Co-pilot-chat-13102024_files/n59ae4ieqq"></script><script type="text/javascript" defer="" src="./Co-pilot-chat-13102024_files/api.js.download"></script></body></html>